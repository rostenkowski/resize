<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="robots" content="noindex,noarchive">
	<meta name="generator" content="Nette Tester">

	<title>Code coverage</title>

	<style type="text/css">
	html {
		font: 14px/1.5 Verdana,"Geneva CE",lucida,sans-serif;
		border-top: 4.7em solid #f4ebdb;
	}

	body {
		max-width: 990px;
		margin: -4.7em auto 0;
		background: #fcfaf5;
		color: #333;
	}

	footer {
		margin-left: .5em;
	}

	h1 {
		font-family: "Trebuchet MS","Geneva CE",lucida,sans-serif;
		font-size: 1.9em;
		margin: .5em .5em 1.5em;
		color: #7a7772;
		text-shadow: 1px 1px 0 white;
	}

	div.code {
		background: white;
		border: 1px dotted silver;
		padding: .4em 0;
		display: none;
		color: #333;
		overflow: auto;
	}

	code,
	div.code {
		font: 13px/1.3 monospace;
	}

	div.code > div {
		float: left;
		min-width: 100%;
		position: relative;
	}

	aside {
		min-width: 100%;
		position: absolute;
	}

	aside div {
		white-space: pre;
		padding-left: .7em;
	}

	aside a {
		color: #c0c0c0;
	}

	aside a:hover {
		color: inherit;
		font-weight: bold;
		text-decoration: none;
	}

	code {
		display: block;
		white-space: nowrap;
		position: relative;
	}

	a {
		color: #006aeb;
		text-decoration: none;
	}

	a:active,
	a:hover {
		text-decoration: underline;
	}

	td {
		vertical-align: middle;
	}

	small {
		color: gray;
	}

	.number {
		text-align: right;
		width: 50px;
	}

	.bar {
		border: 1px solid #acacac;
		background: #e50400;
		width: 35px;
		height: 1em;
	}

	.bar div {
		background: #1a7e1e;
		height: 1em;
	}

	.light td {
		opacity: .5;
	}

	.light td * {
		color: gray;
	}

	.not-loaded td * {
		color: red;
	}

	.t { background-color: #e0ffe0; }
	.u { background-color: #ffe0e0; }

	code .hc { color: #929292; }
	code .hd { color: #333; }
	code .hh { color: #06B; }
	code .hk { color: #e71818; }
	code .hs { color: #008000; }
	</style>
</head>

<body>
	<h1>Code coverage 82&nbsp;%</h1>

		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F0" class="toggle">ImageStore/Directory/Directory.php</a></td>
		</tr>
		</table>

		<div class="code" id="F0">
		<div>
			<aside>
			<div><a href='#F0L1' id='F0L1'>  1</a>
<a href='#F0L2' id='F0L2'>  2</a>
<a href='#F0L3' id='F0L3'>  3</a>
<a href='#F0L4' id='F0L4'>  4</a>
<a href='#F0L5' id='F0L5'>  5</a>
<a href='#F0L6' id='F0L6'>  6</a>
<a href='#F0L7' id='F0L7'>  7</a>
<a href='#F0L8' id='F0L8'>  8</a>
<a href='#F0L9' id='F0L9'>  9</a>
<a href='#F0L10' id='F0L10'> 10</a>
<a href='#F0L11' id='F0L11'> 11</a>
<a href='#F0L12' id='F0L12'> 12</a></div><div class='t'><a href='#F0L13' id='F0L13'> 13</a></div><div><a href='#F0L14' id='F0L14'> 14</a>
<a href='#F0L15' id='F0L15'> 15</a>
<a href='#F0L16' id='F0L16'> 16</a>
<a href='#F0L17' id='F0L17'> 17</a>
<a href='#F0L18' id='F0L18'> 18</a>
<a href='#F0L19' id='F0L19'> 19</a>
<a href='#F0L20' id='F0L20'> 20</a>
<a href='#F0L21' id='F0L21'> 21</a>
<a href='#F0L22' id='F0L22'> 22</a>
<a href='#F0L23' id='F0L23'> 23</a>
<a href='#F0L24' id='F0L24'> 24</a>
<a href='#F0L25' id='F0L25'> 25</a>
<a href='#F0L26' id='F0L26'> 26</a></div><div class='t'><a href='#F0L27' id='F0L27'> 27</a>
<a href='#F0L28' id='F0L28'> 28</a></div><div><a href='#F0L29' id='F0L29'> 29</a>
<a href='#F0L30' id='F0L30'> 30</a>
<a href='#F0L31' id='F0L31'> 31</a>
<a href='#F0L32' id='F0L32'> 32</a>
<a href='#F0L33' id='F0L33'> 33</a>
<a href='#F0L34' id='F0L34'> 34</a>
<a href='#F0L35' id='F0L35'> 35</a>
<a href='#F0L36' id='F0L36'> 36</a>
<a href='#F0L37' id='F0L37'> 37</a>
<a href='#F0L38' id='F0L38'> 38</a>
<a href='#F0L39' id='F0L39'> 39</a>
<a href='#F0L40' id='F0L40'> 40</a></div><div class='t'><a href='#F0L41' id='F0L41'> 41</a>
<a href='#F0L42' id='F0L42'> 42</a></div><div><a href='#F0L43' id='F0L43'> 43</a></div><div class='t'><a href='#F0L44' id='F0L44'> 44</a>
<a href='#F0L45' id='F0L45'> 45</a>
<a href='#F0L46' id='F0L46'> 46</a>
<a href='#F0L47' id='F0L47'> 47</a>
<a href='#F0L48' id='F0L48'> 48</a>
<a href='#F0L49' id='F0L49'> 49</a>
<a href='#F0L50' id='F0L50'> 50</a>
<a href='#F0L51' id='F0L51'> 51</a>
<a href='#F0L52' id='F0L52'> 52</a>
<a href='#F0L53' id='F0L53'> 53</a></div><div><a href='#F0L54' id='F0L54'> 54</a></div><div class='t'><a href='#F0L55' id='F0L55'> 55</a>
<a href='#F0L56' id='F0L56'> 56</a></div><div class='dead'><a href='#F0L57' id='F0L57'> 57</a></div><div><a href='#F0L58' id='F0L58'> 58</a></div><div class='t'><a href='#F0L59' id='F0L59'> 59</a></div><div class='dead'><a href='#F0L60' id='F0L60'> 60</a></div><div><a href='#F0L61' id='F0L61'> 61</a>
<a href='#F0L62' id='F0L62'> 62</a>
<a href='#F0L63' id='F0L63'> 63</a>
<a href='#F0L64' id='F0L64'> 64</a>
<a href='#F0L65' id='F0L65'> 65</a>
<a href='#F0L66' id='F0L66'> 66</a>
<a href='#F0L67' id='F0L67'> 67</a></div><div class='t'><a href='#F0L68' id='F0L68'> 68</a></div><div class='dead'><a href='#F0L69' id='F0L69'> 69</a></div><div><a href='#F0L70' id='F0L70'> 70</a>
<a href='#F0L71' id='F0L71'> 71</a>
<a href='#F0L72' id='F0L72'> 72</a>
<a href='#F0L73' id='F0L73'> 73</a>
<a href='#F0L74' id='F0L74'> 74</a>
<a href='#F0L75' id='F0L75'> 75</a>
<a href='#F0L76' id='F0L76'> 76</a>
<a href='#F0L77' id='F0L77'> 77</a>
<a href='#F0L78' id='F0L78'> 78</a>
<a href='#F0L79' id='F0L79'> 79</a></div><div class='t'><a href='#F0L80' id='F0L80'> 80</a></div><div class='dead'><a href='#F0L81' id='F0L81'> 81</a></div><div><a href='#F0L82' id='F0L82'> 82</a>
<a href='#F0L83' id='F0L83'> 83</a>
<a href='#F0L84' id='F0L84'> 84</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Directory</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Object</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">\</span><span class="hd">DirectoryException</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Directory&nbsp;wrapper<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">Directory&nbsp;</span><span class="hk">extends&nbsp;</span><span class="hd">Object<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$name</span><span class="hk">;<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;&nbsp;$name<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;boolean&nbsp;$tryCreateDirectories<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">$name</span><span class="hk">,&nbsp;</span><span class="hd">$tryCreateDirectories&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">TRUE</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">name&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">check</span><span class="hk">(</span><span class="hd">$name</span><span class="hk">,&nbsp;</span><span class="hd">$tryCreateDirectories</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Checks&nbsp;a&nbsp;directory&nbsp;to&nbsp;be&nbsp;existing&nbsp;and&nbsp;writable.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Tries&nbsp;to&nbsp;create&nbsp;it&nbsp;if&nbsp;it&nbsp;does&nbsp;not&nbsp;exist.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;&nbsp;$name&nbsp;Directory&nbsp;name<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;boolean&nbsp;$tryCreateDirectories<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;Existing&nbsp;and&nbsp;writable&nbsp;directory&nbsp;name<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">check</span><span class="hk">(</span><span class="hd">$name</span><span class="hk">,&nbsp;</span><span class="hd">$tryCreateDirectories&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">TRUE</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$exists&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">TRUE</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$isWritable&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">TRUE</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span class="hd">file_exists</span><span class="hk">(</span><span class="hd">$name</span><span class="hk">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$exists&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">FALSE</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$tryCreateDirectories</span><span class="hk">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">umask</span><span class="hk">(</span><span class="hd">0002</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$exists&nbsp;</span><span class="hk">=&nbsp;@</span><span class="hd">mkdir</span><span class="hk">(</span><span class="hd">$name</span><span class="hk">,&nbsp;</span><span class="hd">0750</span><span class="hk">,&nbsp;</span><span class="hd">TRUE</span><span class="hk">);&nbsp;</span><span class="hc">//&nbsp;@:&nbsp;will&nbsp;be&nbsp;escalated&nbsp;to&nbsp;exception&nbsp;on&nbsp;failure<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span class="hd">is_writable</span><span class="hk">(</span><span class="hd">$name</span><span class="hk">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$isWritable&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">FALSE</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span class="hd">$exists&nbsp;</span><span class="hk">||&nbsp;!</span><span class="hd">$isWritable</span><span class="hk">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span class="hd">DirectoryException</span><span class="hk">(</span><span class="hd">$name</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$name</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">__toString</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(string)&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">name</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;TRUE&nbsp;if&nbsp;the&nbsp;compared&nbsp;directory&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;this,&nbsp;FALSE&nbsp;otherwise.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Directory&nbsp;$to<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;boolean<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">is</span><span class="hk">(</span><span class="hd">Directory&nbsp;$to</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">realpath</span><span class="hk">(</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">name</span><span class="hk">)&nbsp;===&nbsp;</span><span class="hd">realpath</span><span class="hk">(</span><span class="hd">$to</span><span class="hk">-&gt;</span><span class="hd">name</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F1" class="toggle">ImageStore/Meta.php</a></td>
		</tr>
		</table>

		<div class="code" id="F1">
		<div>
			<aside>
			<div><a href='#F1L1' id='F1L1'>  1</a>
<a href='#F1L2' id='F1L2'>  2</a>
<a href='#F1L3' id='F1L3'>  3</a>
<a href='#F1L4' id='F1L4'>  4</a>
<a href='#F1L5' id='F1L5'>  5</a>
<a href='#F1L6' id='F1L6'>  6</a>
<a href='#F1L7' id='F1L7'>  7</a>
<a href='#F1L8' id='F1L8'>  8</a></div><div class='t'><a href='#F1L9' id='F1L9'>  9</a></div><div><a href='#F1L10' id='F1L10'> 10</a>
<a href='#F1L11' id='F1L11'> 11</a>
<a href='#F1L12' id='F1L12'> 12</a>
<a href='#F1L13' id='F1L13'> 13</a>
<a href='#F1L14' id='F1L14'> 14</a>
<a href='#F1L15' id='F1L15'> 15</a>
<a href='#F1L16' id='F1L16'> 16</a>
<a href='#F1L17' id='F1L17'> 17</a>
<a href='#F1L18' id='F1L18'> 18</a>
<a href='#F1L19' id='F1L19'> 19</a>
<a href='#F1L20' id='F1L20'> 20</a>
<a href='#F1L21' id='F1L21'> 21</a>
<a href='#F1L22' id='F1L22'> 22</a>
<a href='#F1L23' id='F1L23'> 23</a>
<a href='#F1L24' id='F1L24'> 24</a>
<a href='#F1L25' id='F1L25'> 25</a>
<a href='#F1L26' id='F1L26'> 26</a>
<a href='#F1L27' id='F1L27'> 27</a>
<a href='#F1L28' id='F1L28'> 28</a>
<a href='#F1L29' id='F1L29'> 29</a>
<a href='#F1L30' id='F1L30'> 30</a>
<a href='#F1L31' id='F1L31'> 31</a>
<a href='#F1L32' id='F1L32'> 32</a>
<a href='#F1L33' id='F1L33'> 33</a>
<a href='#F1L34' id='F1L34'> 34</a>
<a href='#F1L35' id='F1L35'> 35</a>
<a href='#F1L36' id='F1L36'> 36</a>
<a href='#F1L37' id='F1L37'> 37</a>
<a href='#F1L38' id='F1L38'> 38</a>
<a href='#F1L39' id='F1L39'> 39</a>
<a href='#F1L40' id='F1L40'> 40</a>
<a href='#F1L41' id='F1L41'> 41</a>
<a href='#F1L42' id='F1L42'> 42</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">;<br /><br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Image&nbsp;meta&nbsp;information&nbsp;interface<br />&nbsp;*/<br /></span><span class="hk">interface&nbsp;</span><span class="hd">Meta<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;image&nbsp;SHA1&nbsp;hash.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getHash</span><span class="hk">();<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;image&nbsp;type.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getType</span><span class="hk">();<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;image&nbsp;SHA1&nbsp;hash.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$hash<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">setHash</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">);<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;image&nbsp;type.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$type<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">setType</span><span class="hk">(</span><span class="hd">$type</span><span class="hk">);<br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr class='not-loaded'>
			<td class="number"><small>0 %</small></td>
			<td><div class="bar"><div style="width: 0%"></div></div></td>
			<td><a href="#F2" class="toggle">ImageStore/ImageStoreExtension.php</a></td>
		</tr>
		</table>

		<div class="code" id="F2">
		<div>
			<aside>
			<div><a href='#F2L1' id='F2L1'>  1</a>
<a href='#F2L2' id='F2L2'>  2</a>
<a href='#F2L3' id='F2L3'>  3</a>
<a href='#F2L4' id='F2L4'>  4</a>
<a href='#F2L5' id='F2L5'>  5</a>
<a href='#F2L6' id='F2L6'>  6</a>
<a href='#F2L7' id='F2L7'>  7</a>
<a href='#F2L8' id='F2L8'>  8</a>
<a href='#F2L9' id='F2L9'>  9</a>
<a href='#F2L10' id='F2L10'> 10</a>
<a href='#F2L11' id='F2L11'> 11</a>
<a href='#F2L12' id='F2L12'> 12</a>
<a href='#F2L13' id='F2L13'> 13</a>
<a href='#F2L14' id='F2L14'> 14</a>
<a href='#F2L15' id='F2L15'> 15</a>
<a href='#F2L16' id='F2L16'> 16</a>
<a href='#F2L17' id='F2L17'> 17</a>
<a href='#F2L18' id='F2L18'> 18</a>
<a href='#F2L19' id='F2L19'> 19</a>
<a href='#F2L20' id='F2L20'> 20</a>
<a href='#F2L21' id='F2L21'> 21</a>
<a href='#F2L22' id='F2L22'> 22</a>
<a href='#F2L23' id='F2L23'> 23</a>
<a href='#F2L24' id='F2L24'> 24</a>
<a href='#F2L25' id='F2L25'> 25</a>
<a href='#F2L26' id='F2L26'> 26</a>
<a href='#F2L27' id='F2L27'> 27</a>
<a href='#F2L28' id='F2L28'> 28</a>
<a href='#F2L29' id='F2L29'> 29</a>
<a href='#F2L30' id='F2L30'> 30</a>
<a href='#F2L31' id='F2L31'> 31</a>
<a href='#F2L32' id='F2L32'> 32</a>
<a href='#F2L33' id='F2L33'> 33</a>
<a href='#F2L34' id='F2L34'> 34</a>
<a href='#F2L35' id='F2L35'> 35</a>
<a href='#F2L36' id='F2L36'> 36</a>
<a href='#F2L37' id='F2L37'> 37</a>
<a href='#F2L38' id='F2L38'> 38</a>
<a href='#F2L39' id='F2L39'> 39</a>
<a href='#F2L40' id='F2L40'> 40</a>
<a href='#F2L41' id='F2L41'> 41</a>
<a href='#F2L42' id='F2L42'> 42</a>
<a href='#F2L43' id='F2L43'> 43</a>
<a href='#F2L44' id='F2L44'> 44</a>
<a href='#F2L45' id='F2L45'> 45</a>
<a href='#F2L46' id='F2L46'> 46</a>
<a href='#F2L47' id='F2L47'> 47</a>
<a href='#F2L48' id='F2L48'> 48</a>
<a href='#F2L49' id='F2L49'> 49</a>
<a href='#F2L50' id='F2L50'> 50</a>
<a href='#F2L51' id='F2L51'> 51</a>
<a href='#F2L52' id='F2L52'> 52</a>
<a href='#F2L53' id='F2L53'> 53</a>
<a href='#F2L54' id='F2L54'> 54</a>
<a href='#F2L55' id='F2L55'> 55</a>
<a href='#F2L56' id='F2L56'> 56</a>
<a href='#F2L57' id='F2L57'> 57</a>
<a href='#F2L58' id='F2L58'> 58</a>
<a href='#F2L59' id='F2L59'> 59</a>
<a href='#F2L60' id='F2L60'> 60</a>
<a href='#F2L61' id='F2L61'> 61</a>
<a href='#F2L62' id='F2L62'> 62</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">DI</span><span class="hk">\</span><span class="hd">CompilerExtension</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Utils</span><span class="hk">\</span><span class="hd">Validators</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;The&nbsp;Image&nbsp;Extension<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">ImageStoreExtension&nbsp;</span><span class="hk">extends&nbsp;</span><span class="hd">CompilerExtension<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;</span><span class="hd">$options&nbsp;</span><span class="hk">=&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hs">'imageEntity'&nbsp;&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">'Rostenkowski\ImageStore\Entity\ImageEntity'</span><span class="hk">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hs">'storageClass'&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">'Rostenkowski\ImageStore\ImageStorage'</span><span class="hk">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hs">'basePath'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">'/cache/images/'</span><span class="hk">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hs">'cacheDir'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">'%baseDir%/www/cache/images'</span><span class="hk">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hs">'storageDir'&nbsp;&nbsp;&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">'%baseDir%/storage/images'</span><span class="hk">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hs">'macros'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hs">'Rostenkowski\ImageStore\Macro\ImageMacro'</span><span class="hk">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;];<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span class="hd">loadConfiguration</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">options&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">getConfig</span><span class="hk">(</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">options</span><span class="hk">,&nbsp;</span><span class="hd">TRUE</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$builder&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">getContainerBuilder</span><span class="hk">();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">//&nbsp;Image&nbsp;storage<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$builder</span><span class="hk">-&gt;</span><span class="hd">addDefinition</span><span class="hk">(</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">prefix</span><span class="hk">(</span><span class="hs">'storage'</span><span class="hk">))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span class="hd">setClass</span><span class="hk">(</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">options</span><span class="hk">[</span><span class="hs">'storageClass'</span><span class="hk">],&nbsp;[</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">options</span><span class="hk">[</span><span class="hs">'storageDir'</span><span class="hk">],&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">options</span><span class="hk">[</span><span class="hs">'cacheDir'</span><span class="hk">],&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">options</span><span class="hk">[</span><span class="hs">'basePath'</span><span class="hk">]]);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">//&nbsp;Latte&nbsp;macros<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">addMacros</span><span class="hk">(</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">options</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;macros&nbsp;(found&nbsp;in&nbsp;$options)&nbsp;to&nbsp;latte&nbsp;factory&nbsp;definition.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">addMacros</span><span class="hk">(</span><span class="hd">$options</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$builder&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">getContainerBuilder</span><span class="hk">();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">array_key_exists</span><span class="hk">(</span><span class="hs">'macros'</span><span class="hk">,&nbsp;</span><span class="hd">$options</span><span class="hk">)&nbsp;&amp;&amp;&nbsp;</span><span class="hd">is_array</span><span class="hk">(</span><span class="hd">$options</span><span class="hk">[</span><span class="hs">'macros'</span><span class="hk">]))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$factory&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$builder</span><span class="hk">-&gt;</span><span class="hd">getDefinition</span><span class="hk">(</span><span class="hs">'nette.latteFactory'</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span class="hd">$options</span><span class="hk">[</span><span class="hs">'macros'</span><span class="hk">]&nbsp;as&nbsp;</span><span class="hd">$macro</span><span class="hk">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">strpos</span><span class="hk">(</span><span class="hd">$macro</span><span class="hk">,&nbsp;</span><span class="hs">'::'</span><span class="hk">)&nbsp;===&nbsp;</span><span class="hd">FALSE&nbsp;</span><span class="hk">&amp;&amp;&nbsp;</span><span class="hd">class_exists</span><span class="hk">(</span><span class="hd">$macro</span><span class="hk">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$macro&nbsp;</span><span class="hk">.=&nbsp;</span><span class="hs">'::install'</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">Validators</span><span class="hk">::</span><span class="hd">assert</span><span class="hk">(</span><span class="hd">$macro</span><span class="hk">,&nbsp;</span><span class="hs">'callable'</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$factory</span><span class="hk">-&gt;</span><span class="hd">addSetup</span><span class="hk">(</span><span class="hd">$macro&nbsp;</span><span class="hk">.&nbsp;</span><span class="hs">'(?-&gt;getCompiler())'</span><span class="hk">,&nbsp;array(</span><span class="hs">'@self'</span><span class="hk">));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F3" class="toggle">ImageStore/Files/ImageFile.php</a></td>
		</tr>
		</table>

		<div class="code" id="F3">
		<div>
			<aside>
			<div><a href='#F3L1' id='F3L1'>  1</a>
<a href='#F3L2' id='F3L2'>  2</a>
<a href='#F3L3' id='F3L3'>  3</a>
<a href='#F3L4' id='F3L4'>  4</a>
<a href='#F3L5' id='F3L5'>  5</a>
<a href='#F3L6' id='F3L6'>  6</a>
<a href='#F3L7' id='F3L7'>  7</a>
<a href='#F3L8' id='F3L8'>  8</a>
<a href='#F3L9' id='F3L9'>  9</a>
<a href='#F3L10' id='F3L10'> 10</a>
<a href='#F3L11' id='F3L11'> 11</a></div><div class='t'><a href='#F3L12' id='F3L12'> 12</a></div><div><a href='#F3L13' id='F3L13'> 13</a>
<a href='#F3L14' id='F3L14'> 14</a>
<a href='#F3L15' id='F3L15'> 15</a>
<a href='#F3L16' id='F3L16'> 16</a>
<a href='#F3L17' id='F3L17'> 17</a>
<a href='#F3L18' id='F3L18'> 18</a>
<a href='#F3L19' id='F3L19'> 19</a>
<a href='#F3L20' id='F3L20'> 20</a>
<a href='#F3L21' id='F3L21'> 21</a>
<a href='#F3L22' id='F3L22'> 22</a>
<a href='#F3L23' id='F3L23'> 23</a>
<a href='#F3L24' id='F3L24'> 24</a>
<a href='#F3L25' id='F3L25'> 25</a>
<a href='#F3L26' id='F3L26'> 26</a>
<a href='#F3L27' id='F3L27'> 27</a>
<a href='#F3L28' id='F3L28'> 28</a>
<a href='#F3L29' id='F3L29'> 29</a>
<a href='#F3L30' id='F3L30'> 30</a>
<a href='#F3L31' id='F3L31'> 31</a></div><div class='t'><a href='#F3L32' id='F3L32'> 32</a></div><div><a href='#F3L33' id='F3L33'> 33</a></div><div class='t'><a href='#F3L34' id='F3L34'> 34</a>
<a href='#F3L35' id='F3L35'> 35</a></div><div class='dead'><a href='#F3L36' id='F3L36'> 36</a></div><div class='t'><a href='#F3L37' id='F3L37'> 37</a>
<a href='#F3L38' id='F3L38'> 38</a>
<a href='#F3L39' id='F3L39'> 39</a></div><div><a href='#F3L40' id='F3L40'> 40</a>
<a href='#F3L41' id='F3L41'> 41</a>
<a href='#F3L42' id='F3L42'> 42</a>
<a href='#F3L43' id='F3L43'> 43</a></div><div class='t'><a href='#F3L44' id='F3L44'> 44</a></div><div class='dead'><a href='#F3L45' id='F3L45'> 45</a></div><div><a href='#F3L46' id='F3L46'> 46</a>
<a href='#F3L47' id='F3L47'> 47</a>
<a href='#F3L48' id='F3L48'> 48</a>
<a href='#F3L49' id='F3L49'> 49</a></div><div class='t'><a href='#F3L50' id='F3L50'> 50</a>
<a href='#F3L51' id='F3L51'> 51</a></div><div><a href='#F3L52' id='F3L52'> 52</a>
<a href='#F3L53' id='F3L53'> 53</a>
<a href='#F3L54' id='F3L54'> 54</a>
<a href='#F3L55' id='F3L55'> 55</a></div><div class='t'><a href='#F3L56' id='F3L56'> 56</a></div><div class='dead'><a href='#F3L57' id='F3L57'> 57</a></div><div><a href='#F3L58' id='F3L58'> 58</a>
<a href='#F3L59' id='F3L59'> 59</a>
<a href='#F3L60' id='F3L60'> 60</a>
<a href='#F3L61' id='F3L61'> 61</a></div><div class='t'><a href='#F3L62' id='F3L62'> 62</a>
<a href='#F3L63' id='F3L63'> 63</a></div><div><a href='#F3L64' id='F3L64'> 64</a>
<a href='#F3L65' id='F3L65'> 65</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Files</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">\</span><span class="hd">ImageFileException</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">File</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Simple&nbsp;image&nbsp;file&nbsp;wrapper<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">ImageFile&nbsp;</span><span class="hk">implements&nbsp;</span><span class="hd">File<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;file&nbsp;name<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$name</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;image&nbsp;type<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$type</span><span class="hk">;<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$info&nbsp;</span><span class="hk">=&nbsp;@</span><span class="hd">getimagesize</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">);&nbsp;</span><span class="hc">//&nbsp;@:&nbsp;will&nbsp;be&nbsp;escalated&nbsp;to&nbsp;exception&nbsp;on&nbsp;failure<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">if&nbsp;(</span><span class="hd">$info&nbsp;</span><span class="hk">===&nbsp;</span><span class="hd">FALSE</span><span class="hk">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span class="hd">ImageFileException</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">setName</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">setType</span><span class="hk">(</span><span class="hd">$info</span><span class="hk">[</span><span class="hd">2</span><span class="hk">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span class="hd">getType</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">type</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span class="hd">setType</span><span class="hk">(</span><span class="hd">$type</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">type&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$type</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span class="hd">getName</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">name</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span class="hd">setName</span><span class="hk">(</span><span class="hd">$name</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">name&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$name</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F4" class="toggle">ImageStore/ImageStorage.php</a></td>
		</tr>
		</table>

		<div class="code" id="F4">
		<div>
			<aside>
			<div><a href='#F4L1' id='F4L1'>   1</a>
<a href='#F4L2' id='F4L2'>   2</a>
<a href='#F4L3' id='F4L3'>   3</a>
<a href='#F4L4' id='F4L4'>   4</a>
<a href='#F4L5' id='F4L5'>   5</a>
<a href='#F4L6' id='F4L6'>   6</a>
<a href='#F4L7' id='F4L7'>   7</a>
<a href='#F4L8' id='F4L8'>   8</a>
<a href='#F4L9' id='F4L9'>   9</a>
<a href='#F4L10' id='F4L10'>  10</a>
<a href='#F4L11' id='F4L11'>  11</a>
<a href='#F4L12' id='F4L12'>  12</a>
<a href='#F4L13' id='F4L13'>  13</a>
<a href='#F4L14' id='F4L14'>  14</a>
<a href='#F4L15' id='F4L15'>  15</a>
<a href='#F4L16' id='F4L16'>  16</a>
<a href='#F4L17' id='F4L17'>  17</a>
<a href='#F4L18' id='F4L18'>  18</a>
<a href='#F4L19' id='F4L19'>  19</a>
<a href='#F4L20' id='F4L20'>  20</a>
<a href='#F4L21' id='F4L21'>  21</a>
<a href='#F4L22' id='F4L22'>  22</a>
<a href='#F4L23' id='F4L23'>  23</a>
<a href='#F4L24' id='F4L24'>  24</a>
<a href='#F4L25' id='F4L25'>  25</a>
<a href='#F4L26' id='F4L26'>  26</a>
<a href='#F4L27' id='F4L27'>  27</a>
<a href='#F4L28' id='F4L28'>  28</a>
<a href='#F4L29' id='F4L29'>  29</a></div><div class='t'><a href='#F4L30' id='F4L30'>  30</a></div><div><a href='#F4L31' id='F4L31'>  31</a>
<a href='#F4L32' id='F4L32'>  32</a>
<a href='#F4L33' id='F4L33'>  33</a>
<a href='#F4L34' id='F4L34'>  34</a>
<a href='#F4L35' id='F4L35'>  35</a>
<a href='#F4L36' id='F4L36'>  36</a>
<a href='#F4L37' id='F4L37'>  37</a>
<a href='#F4L38' id='F4L38'>  38</a>
<a href='#F4L39' id='F4L39'>  39</a>
<a href='#F4L40' id='F4L40'>  40</a>
<a href='#F4L41' id='F4L41'>  41</a>
<a href='#F4L42' id='F4L42'>  42</a>
<a href='#F4L43' id='F4L43'>  43</a>
<a href='#F4L44' id='F4L44'>  44</a>
<a href='#F4L45' id='F4L45'>  45</a>
<a href='#F4L46' id='F4L46'>  46</a>
<a href='#F4L47' id='F4L47'>  47</a>
<a href='#F4L48' id='F4L48'>  48</a>
<a href='#F4L49' id='F4L49'>  49</a>
<a href='#F4L50' id='F4L50'>  50</a>
<a href='#F4L51' id='F4L51'>  51</a>
<a href='#F4L52' id='F4L52'>  52</a>
<a href='#F4L53' id='F4L53'>  53</a>
<a href='#F4L54' id='F4L54'>  54</a>
<a href='#F4L55' id='F4L55'>  55</a>
<a href='#F4L56' id='F4L56'>  56</a>
<a href='#F4L57' id='F4L57'>  57</a>
<a href='#F4L58' id='F4L58'>  58</a>
<a href='#F4L59' id='F4L59'>  59</a>
<a href='#F4L60' id='F4L60'>  60</a>
<a href='#F4L61' id='F4L61'>  61</a>
<a href='#F4L62' id='F4L62'>  62</a>
<a href='#F4L63' id='F4L63'>  63</a>
<a href='#F4L64' id='F4L64'>  64</a>
<a href='#F4L65' id='F4L65'>  65</a>
<a href='#F4L66' id='F4L66'>  66</a>
<a href='#F4L67' id='F4L67'>  67</a>
<a href='#F4L68' id='F4L68'>  68</a>
<a href='#F4L69' id='F4L69'>  69</a>
<a href='#F4L70' id='F4L70'>  70</a>
<a href='#F4L71' id='F4L71'>  71</a>
<a href='#F4L72' id='F4L72'>  72</a>
<a href='#F4L73' id='F4L73'>  73</a>
<a href='#F4L74' id='F4L74'>  74</a>
<a href='#F4L75' id='F4L75'>  75</a>
<a href='#F4L76' id='F4L76'>  76</a>
<a href='#F4L77' id='F4L77'>  77</a>
<a href='#F4L78' id='F4L78'>  78</a></div><div class='t'><a href='#F4L79' id='F4L79'>  79</a>
<a href='#F4L80' id='F4L80'>  80</a></div><div><a href='#F4L81' id='F4L81'>  81</a></div><div class='t'><a href='#F4L82' id='F4L82'>  82</a>
<a href='#F4L83' id='F4L83'>  83</a></div><div class='dead'><a href='#F4L84' id='F4L84'>  84</a></div><div><a href='#F4L85' id='F4L85'>  85</a></div><div class='t'><a href='#F4L86' id='F4L86'>  86</a>
<a href='#F4L87' id='F4L87'>  87</a></div><div><a href='#F4L88' id='F4L88'>  88</a>
<a href='#F4L89' id='F4L89'>  89</a>
<a href='#F4L90' id='F4L90'>  90</a>
<a href='#F4L91' id='F4L91'>  91</a>
<a href='#F4L92' id='F4L92'>  92</a>
<a href='#F4L93' id='F4L93'>  93</a>
<a href='#F4L94' id='F4L94'>  94</a>
<a href='#F4L95' id='F4L95'>  95</a>
<a href='#F4L96' id='F4L96'>  96</a>
<a href='#F4L97' id='F4L97'>  97</a>
<a href='#F4L98' id='F4L98'>  98</a></div><div class='t'><a href='#F4L99' id='F4L99'>  99</a></div><div><a href='#F4L100' id='F4L100'> 100</a></div><div class='t'><a href='#F4L101' id='F4L101'> 101</a></div><div class='dead'><a href='#F4L102' id='F4L102'> 102</a></div><div><a href='#F4L103' id='F4L103'> 103</a>
<a href='#F4L104' id='F4L104'> 104</a>
<a href='#F4L105' id='F4L105'> 105</a>
<a href='#F4L106' id='F4L106'> 106</a>
<a href='#F4L107' id='F4L107'> 107</a>
<a href='#F4L108' id='F4L108'> 108</a>
<a href='#F4L109' id='F4L109'> 109</a>
<a href='#F4L110' id='F4L110'> 110</a>
<a href='#F4L111' id='F4L111'> 111</a>
<a href='#F4L112' id='F4L112'> 112</a>
<a href='#F4L113' id='F4L113'> 113</a></div><div class='t'><a href='#F4L114' id='F4L114'> 114</a>
<a href='#F4L115' id='F4L115'> 115</a>
<a href='#F4L116' id='F4L116'> 116</a>
<a href='#F4L117' id='F4L117'> 117</a>
<a href='#F4L118' id='F4L118'> 118</a>
<a href='#F4L119' id='F4L119'> 119</a></div><div><a href='#F4L120' id='F4L120'> 120</a>
<a href='#F4L121' id='F4L121'> 121</a>
<a href='#F4L122' id='F4L122'> 122</a>
<a href='#F4L123' id='F4L123'> 123</a>
<a href='#F4L124' id='F4L124'> 124</a>
<a href='#F4L125' id='F4L125'> 125</a>
<a href='#F4L126' id='F4L126'> 126</a>
<a href='#F4L127' id='F4L127'> 127</a>
<a href='#F4L128' id='F4L128'> 128</a>
<a href='#F4L129' id='F4L129'> 129</a></div><div class='t'><a href='#F4L130' id='F4L130'> 130</a>
<a href='#F4L131' id='F4L131'> 131</a>
<a href='#F4L132' id='F4L132'> 132</a></div><div><a href='#F4L133' id='F4L133'> 133</a></div><div class='t'><a href='#F4L134' id='F4L134'> 134</a></div><div><a href='#F4L135' id='F4L135'> 135</a></div><div class='t'><a href='#F4L136' id='F4L136'> 136</a></div><div><a href='#F4L137' id='F4L137'> 137</a></div><div class='t'><a href='#F4L138' id='F4L138'> 138</a></div><div class='dead'><a href='#F4L139' id='F4L139'> 139</a></div><div><a href='#F4L140' id='F4L140'> 140</a>
<a href='#F4L141' id='F4L141'> 141</a>
<a href='#F4L142' id='F4L142'> 142</a>
<a href='#F4L143' id='F4L143'> 143</a>
<a href='#F4L144' id='F4L144'> 144</a>
<a href='#F4L145' id='F4L145'> 145</a>
<a href='#F4L146' id='F4L146'> 146</a>
<a href='#F4L147' id='F4L147'> 147</a>
<a href='#F4L148' id='F4L148'> 148</a>
<a href='#F4L149' id='F4L149'> 149</a></div><div class='t'><a href='#F4L150' id='F4L150'> 150</a></div><div class='dead'><a href='#F4L151' id='F4L151'> 151</a></div><div><a href='#F4L152' id='F4L152'> 152</a>
<a href='#F4L153' id='F4L153'> 153</a>
<a href='#F4L154' id='F4L154'> 154</a>
<a href='#F4L155' id='F4L155'> 155</a>
<a href='#F4L156' id='F4L156'> 156</a>
<a href='#F4L157' id='F4L157'> 157</a>
<a href='#F4L158' id='F4L158'> 158</a></div><div class='t'><a href='#F4L159' id='F4L159'> 159</a></div><div><a href='#F4L160' id='F4L160'> 160</a>
<a href='#F4L161' id='F4L161'> 161</a>
<a href='#F4L162' id='F4L162'> 162</a>
<a href='#F4L163' id='F4L163'> 163</a>
<a href='#F4L164' id='F4L164'> 164</a>
<a href='#F4L165' id='F4L165'> 165</a></div><div class='t'><a href='#F4L166' id='F4L166'> 166</a>
<a href='#F4L167' id='F4L167'> 167</a></div><div class='dead'><a href='#F4L168' id='F4L168'> 168</a></div><div><a href='#F4L169' id='F4L169'> 169</a></div><div class='t'><a href='#F4L170' id='F4L170'> 170</a></div><div class='dead'><a href='#F4L171' id='F4L171'> 171</a></div><div><a href='#F4L172' id='F4L172'> 172</a>
<a href='#F4L173' id='F4L173'> 173</a>
<a href='#F4L174' id='F4L174'> 174</a>
<a href='#F4L175' id='F4L175'> 175</a>
<a href='#F4L176' id='F4L176'> 176</a>
<a href='#F4L177' id='F4L177'> 177</a>
<a href='#F4L178' id='F4L178'> 178</a>
<a href='#F4L179' id='F4L179'> 179</a>
<a href='#F4L180' id='F4L180'> 180</a>
<a href='#F4L181' id='F4L181'> 181</a>
<a href='#F4L182' id='F4L182'> 182</a></div><div class='t'><a href='#F4L183' id='F4L183'> 183</a></div><div class='dead'><a href='#F4L184' id='F4L184'> 184</a></div><div><a href='#F4L185' id='F4L185'> 185</a>
<a href='#F4L186' id='F4L186'> 186</a>
<a href='#F4L187' id='F4L187'> 187</a>
<a href='#F4L188' id='F4L188'> 188</a>
<a href='#F4L189' id='F4L189'> 189</a>
<a href='#F4L190' id='F4L190'> 190</a>
<a href='#F4L191' id='F4L191'> 191</a>
<a href='#F4L192' id='F4L192'> 192</a>
<a href='#F4L193' id='F4L193'> 193</a>
<a href='#F4L194' id='F4L194'> 194</a></div><div class='t'><a href='#F4L195' id='F4L195'> 195</a>
<a href='#F4L196' id='F4L196'> 196</a></div><div><a href='#F4L197' id='F4L197'> 197</a></div><div class='t'><a href='#F4L198' id='F4L198'> 198</a></div><div class='dead'><a href='#F4L199' id='F4L199'> 199</a></div><div><a href='#F4L200' id='F4L200'> 200</a>
<a href='#F4L201' id='F4L201'> 201</a>
<a href='#F4L202' id='F4L202'> 202</a>
<a href='#F4L203' id='F4L203'> 203</a>
<a href='#F4L204' id='F4L204'> 204</a>
<a href='#F4L205' id='F4L205'> 205</a>
<a href='#F4L206' id='F4L206'> 206</a>
<a href='#F4L207' id='F4L207'> 207</a>
<a href='#F4L208' id='F4L208'> 208</a>
<a href='#F4L209' id='F4L209'> 209</a></div><div class='t'><a href='#F4L210' id='F4L210'> 210</a></div><div class='dead'><a href='#F4L211' id='F4L211'> 211</a></div><div><a href='#F4L212' id='F4L212'> 212</a>
<a href='#F4L213' id='F4L213'> 213</a>
<a href='#F4L214' id='F4L214'> 214</a>
<a href='#F4L215' id='F4L215'> 215</a>
<a href='#F4L216' id='F4L216'> 216</a>
<a href='#F4L217' id='F4L217'> 217</a>
<a href='#F4L218' id='F4L218'> 218</a>
<a href='#F4L219' id='F4L219'> 219</a>
<a href='#F4L220' id='F4L220'> 220</a>
<a href='#F4L221' id='F4L221'> 221</a></div><div class='t'><a href='#F4L222' id='F4L222'> 222</a></div><div><a href='#F4L223' id='F4L223'> 223</a></div><div class='t'><a href='#F4L224' id='F4L224'> 224</a></div><div class='dead'><a href='#F4L225' id='F4L225'> 225</a></div><div><a href='#F4L226' id='F4L226'> 226</a>
<a href='#F4L227' id='F4L227'> 227</a>
<a href='#F4L228' id='F4L228'> 228</a>
<a href='#F4L229' id='F4L229'> 229</a>
<a href='#F4L230' id='F4L230'> 230</a>
<a href='#F4L231' id='F4L231'> 231</a>
<a href='#F4L232' id='F4L232'> 232</a>
<a href='#F4L233' id='F4L233'> 233</a>
<a href='#F4L234' id='F4L234'> 234</a>
<a href='#F4L235' id='F4L235'> 235</a></div><div class='t'><a href='#F4L236' id='F4L236'> 236</a></div><div class='dead'><a href='#F4L237' id='F4L237'> 237</a></div><div><a href='#F4L238' id='F4L238'> 238</a>
<a href='#F4L239' id='F4L239'> 239</a>
<a href='#F4L240' id='F4L240'> 240</a>
<a href='#F4L241' id='F4L241'> 241</a>
<a href='#F4L242' id='F4L242'> 242</a>
<a href='#F4L243' id='F4L243'> 243</a>
<a href='#F4L244' id='F4L244'> 244</a>
<a href='#F4L245' id='F4L245'> 245</a>
<a href='#F4L246' id='F4L246'> 246</a>
<a href='#F4L247' id='F4L247'> 247</a>
<a href='#F4L248' id='F4L248'> 248</a>
<a href='#F4L249' id='F4L249'> 249</a></div><div class='t'><a href='#F4L250' id='F4L250'> 250</a>
<a href='#F4L251' id='F4L251'> 251</a></div><div class='dead'><a href='#F4L252' id='F4L252'> 252</a></div><div><a href='#F4L253' id='F4L253'> 253</a></div><div class='t'><a href='#F4L254' id='F4L254'> 254</a>
<a href='#F4L255' id='F4L255'> 255</a>
<a href='#F4L256' id='F4L256'> 256</a></div><div><a href='#F4L257' id='F4L257'> 257</a></div><div class='t'><a href='#F4L258' id='F4L258'> 258</a>
<a href='#F4L259' id='F4L259'> 259</a>
<a href='#F4L260' id='F4L260'> 260</a>
<a href='#F4L261' id='F4L261'> 261</a>
<a href='#F4L262' id='F4L262'> 262</a>
<a href='#F4L263' id='F4L263'> 263</a></div><div><a href='#F4L264' id='F4L264'> 264</a></div><div class='t'><a href='#F4L265' id='F4L265'> 265</a>
<a href='#F4L266' id='F4L266'> 266</a></div><div><a href='#F4L267' id='F4L267'> 267</a></div><div class='t'><a href='#F4L268' id='F4L268'> 268</a></div><div class='dead'><a href='#F4L269' id='F4L269'> 269</a></div><div><a href='#F4L270' id='F4L270'> 270</a>
<a href='#F4L271' id='F4L271'> 271</a>
<a href='#F4L272' id='F4L272'> 272</a>
<a href='#F4L273' id='F4L273'> 273</a>
<a href='#F4L274' id='F4L274'> 274</a>
<a href='#F4L275' id='F4L275'> 275</a>
<a href='#F4L276' id='F4L276'> 276</a>
<a href='#F4L277' id='F4L277'> 277</a>
<a href='#F4L278' id='F4L278'> 278</a>
<a href='#F4L279' id='F4L279'> 279</a></div><div class='t'><a href='#F4L280' id='F4L280'> 280</a>
<a href='#F4L281' id='F4L281'> 281</a></div><div><a href='#F4L282' id='F4L282'> 282</a></div><div class='t'><a href='#F4L283' id='F4L283'> 283</a></div><div class='dead'><a href='#F4L284' id='F4L284'> 284</a></div><div><a href='#F4L285' id='F4L285'> 285</a>
<a href='#F4L286' id='F4L286'> 286</a>
<a href='#F4L287' id='F4L287'> 287</a>
<a href='#F4L288' id='F4L288'> 288</a>
<a href='#F4L289' id='F4L289'> 289</a>
<a href='#F4L290' id='F4L290'> 290</a>
<a href='#F4L291' id='F4L291'> 291</a>
<a href='#F4L292' id='F4L292'> 292</a>
<a href='#F4L293' id='F4L293'> 293</a>
<a href='#F4L294' id='F4L294'> 294</a></div><div class='t'><a href='#F4L295' id='F4L295'> 295</a>
<a href='#F4L296' id='F4L296'> 296</a></div><div><a href='#F4L297' id='F4L297'> 297</a></div><div class='t'><a href='#F4L298' id='F4L298'> 298</a></div><div class='dead'><a href='#F4L299' id='F4L299'> 299</a></div><div><a href='#F4L300' id='F4L300'> 300</a>
<a href='#F4L301' id='F4L301'> 301</a>
<a href='#F4L302' id='F4L302'> 302</a>
<a href='#F4L303' id='F4L303'> 303</a>
<a href='#F4L304' id='F4L304'> 304</a>
<a href='#F4L305' id='F4L305'> 305</a>
<a href='#F4L306' id='F4L306'> 306</a>
<a href='#F4L307' id='F4L307'> 307</a>
<a href='#F4L308' id='F4L308'> 308</a>
<a href='#F4L309' id='F4L309'> 309</a></div><div class='t'><a href='#F4L310' id='F4L310'> 310</a>
<a href='#F4L311' id='F4L311'> 311</a>
<a href='#F4L312' id='F4L312'> 312</a>
<a href='#F4L313' id='F4L313'> 313</a>
<a href='#F4L314' id='F4L314'> 314</a>
<a href='#F4L315' id='F4L315'> 315</a></div><div><a href='#F4L316' id='F4L316'> 316</a></div><div class='t'><a href='#F4L317' id='F4L317'> 317</a></div><div class='dead'><a href='#F4L318' id='F4L318'> 318</a></div><div><a href='#F4L319' id='F4L319'> 319</a>
<a href='#F4L320' id='F4L320'> 320</a>
<a href='#F4L321' id='F4L321'> 321</a>
<a href='#F4L322' id='F4L322'> 322</a>
<a href='#F4L323' id='F4L323'> 323</a>
<a href='#F4L324' id='F4L324'> 324</a>
<a href='#F4L325' id='F4L325'> 325</a>
<a href='#F4L326' id='F4L326'> 326</a>
<a href='#F4L327' id='F4L327'> 327</a>
<a href='#F4L328' id='F4L328'> 328</a></div><div class='t'><a href='#F4L329' id='F4L329'> 329</a></div><div><a href='#F4L330' id='F4L330'> 330</a></div><div class='t'><a href='#F4L331' id='F4L331'> 331</a></div><div><a href='#F4L332' id='F4L332'> 332</a></div><div class='t'><a href='#F4L333' id='F4L333'> 333</a></div><div><a href='#F4L334' id='F4L334'> 334</a></div><div class='t'><a href='#F4L335' id='F4L335'> 335</a></div><div><a href='#F4L336' id='F4L336'> 336</a>
<a href='#F4L337' id='F4L337'> 337</a></div><div class='t'><a href='#F4L338' id='F4L338'> 338</a>
<a href='#F4L339' id='F4L339'> 339</a>
<a href='#F4L340' id='F4L340'> 340</a></div><div><a href='#F4L341' id='F4L341'> 341</a></div><div class='t'><a href='#F4L342' id='F4L342'> 342</a></div><div><a href='#F4L343' id='F4L343'> 343</a></div><div class='t'><a href='#F4L344' id='F4L344'> 344</a></div><div><a href='#F4L345' id='F4L345'> 345</a></div><div class='t'><a href='#F4L346' id='F4L346'> 346</a>
<a href='#F4L347' id='F4L347'> 347</a>
<a href='#F4L348' id='F4L348'> 348</a>
<a href='#F4L349' id='F4L349'> 349</a></div><div><a href='#F4L350' id='F4L350'> 350</a></div><div class='t'><a href='#F4L351' id='F4L351'> 351</a>
<a href='#F4L352' id='F4L352'> 352</a>
<a href='#F4L353' id='F4L353'> 353</a>
<a href='#F4L354' id='F4L354'> 354</a></div><div><a href='#F4L355' id='F4L355'> 355</a>
<a href='#F4L356' id='F4L356'> 356</a>
<a href='#F4L357' id='F4L357'> 357</a>
<a href='#F4L358' id='F4L358'> 358</a>
<a href='#F4L359' id='F4L359'> 359</a>
<a href='#F4L360' id='F4L360'> 360</a>
<a href='#F4L361' id='F4L361'> 361</a>
<a href='#F4L362' id='F4L362'> 362</a>
<a href='#F4L363' id='F4L363'> 363</a>
<a href='#F4L364' id='F4L364'> 364</a></div><div class='t'><a href='#F4L365' id='F4L365'> 365</a></div><div><a href='#F4L366' id='F4L366'> 366</a></div><div class='t'><a href='#F4L367' id='F4L367'> 367</a></div><div class='dead'><a href='#F4L368' id='F4L368'> 368</a></div><div><a href='#F4L369' id='F4L369'> 369</a>
<a href='#F4L370' id='F4L370'> 370</a>
<a href='#F4L371' id='F4L371'> 371</a>
<a href='#F4L372' id='F4L372'> 372</a>
<a href='#F4L373' id='F4L373'> 373</a>
<a href='#F4L374' id='F4L374'> 374</a>
<a href='#F4L375' id='F4L375'> 375</a>
<a href='#F4L376' id='F4L376'> 376</a>
<a href='#F4L377' id='F4L377'> 377</a>
<a href='#F4L378' id='F4L378'> 378</a>
<a href='#F4L379' id='F4L379'> 379</a></div><div class='t'><a href='#F4L380' id='F4L380'> 380</a></div><div><a href='#F4L381' id='F4L381'> 381</a></div><div class='t'><a href='#F4L382' id='F4L382'> 382</a></div><div class='dead'><a href='#F4L383' id='F4L383'> 383</a></div><div><a href='#F4L384' id='F4L384'> 384</a></div><div class='t'><a href='#F4L385' id='F4L385'> 385</a></div><div><a href='#F4L386' id='F4L386'> 386</a></div><div class='t'><a href='#F4L387' id='F4L387'> 387</a>
<a href='#F4L388' id='F4L388'> 388</a></div><div><a href='#F4L389' id='F4L389'> 389</a></div><div class='t'><a href='#F4L390' id='F4L390'> 390</a>
<a href='#F4L391' id='F4L391'> 391</a>
<a href='#F4L392' id='F4L392'> 392</a></div><div><a href='#F4L393' id='F4L393'> 393</a></div><div class='t'><a href='#F4L394' id='F4L394'> 394</a>
<a href='#F4L395' id='F4L395'> 395</a></div><div><a href='#F4L396' id='F4L396'> 396</a></div><div class='t'><a href='#F4L397' id='F4L397'> 397</a></div><div><a href='#F4L398' id='F4L398'> 398</a></div><div class='t'><a href='#F4L399' id='F4L399'> 399</a></div><div><a href='#F4L400' id='F4L400'> 400</a></div><div class='t'><a href='#F4L401' id='F4L401'> 401</a>
<a href='#F4L402' id='F4L402'> 402</a></div><div><a href='#F4L403' id='F4L403'> 403</a></div><div class='t'><a href='#F4L404' id='F4L404'> 404</a>
<a href='#F4L405' id='F4L405'> 405</a></div><div><a href='#F4L406' id='F4L406'> 406</a></div><div class='t'><a href='#F4L407' id='F4L407'> 407</a>
<a href='#F4L408' id='F4L408'> 408</a>
<a href='#F4L409' id='F4L409'> 409</a></div><div><a href='#F4L410' id='F4L410'> 410</a></div><div class='t'><a href='#F4L411' id='F4L411'> 411</a>
<a href='#F4L412' id='F4L412'> 412</a>
<a href='#F4L413' id='F4L413'> 413</a></div><div><a href='#F4L414' id='F4L414'> 414</a></div><div class='t'><a href='#F4L415' id='F4L415'> 415</a></div><div><a href='#F4L416' id='F4L416'> 416</a></div><div class='t'><a href='#F4L417' id='F4L417'> 417</a>
<a href='#F4L418' id='F4L418'> 418</a></div><div><a href='#F4L419' id='F4L419'> 419</a></div><div class='t'><a href='#F4L420' id='F4L420'> 420</a>
<a href='#F4L421' id='F4L421'> 421</a></div><div><a href='#F4L422' id='F4L422'> 422</a>
<a href='#F4L423' id='F4L423'> 423</a></div><div class='t'><a href='#F4L424' id='F4L424'> 424</a></div><div><a href='#F4L425' id='F4L425'> 425</a></div><div class='t'><a href='#F4L426' id='F4L426'> 426</a></div><div><a href='#F4L427' id='F4L427'> 427</a></div><div class='t'><a href='#F4L428' id='F4L428'> 428</a>
<a href='#F4L429' id='F4L429'> 429</a></div><div><a href='#F4L430' id='F4L430'> 430</a></div><div class='t'><a href='#F4L431' id='F4L431'> 431</a>
<a href='#F4L432' id='F4L432'> 432</a></div><div><a href='#F4L433' id='F4L433'> 433</a></div><div class='t'><a href='#F4L434' id='F4L434'> 434</a></div><div><a href='#F4L435' id='F4L435'> 435</a></div><div class='t'><a href='#F4L436' id='F4L436'> 436</a>
<a href='#F4L437' id='F4L437'> 437</a></div><div><a href='#F4L438' id='F4L438'> 438</a></div><div class='t'><a href='#F4L439' id='F4L439'> 439</a>
<a href='#F4L440' id='F4L440'> 440</a></div><div><a href='#F4L441' id='F4L441'> 441</a>
<a href='#F4L442' id='F4L442'> 442</a>
<a href='#F4L443' id='F4L443'> 443</a>
<a href='#F4L444' id='F4L444'> 444</a></div><div class='t'><a href='#F4L445' id='F4L445'> 445</a>
<a href='#F4L446' id='F4L446'> 446</a></div><div><a href='#F4L447' id='F4L447'> 447</a></div><div class='t'><a href='#F4L448' id='F4L448'> 448</a></div><div class='dead'><a href='#F4L449' id='F4L449'> 449</a></div><div><a href='#F4L450' id='F4L450'> 450</a>
<a href='#F4L451' id='F4L451'> 451</a>
<a href='#F4L452' id='F4L452'> 452</a>
<a href='#F4L453' id='F4L453'> 453</a>
<a href='#F4L454' id='F4L454'> 454</a>
<a href='#F4L455' id='F4L455'> 455</a>
<a href='#F4L456' id='F4L456'> 456</a>
<a href='#F4L457' id='F4L457'> 457</a>
<a href='#F4L458' id='F4L458'> 458</a>
<a href='#F4L459' id='F4L459'> 459</a>
<a href='#F4L460' id='F4L460'> 460</a></div><div class='t'><a href='#F4L461' id='F4L461'> 461</a></div><div><a href='#F4L462' id='F4L462'> 462</a></div><div class='t'><a href='#F4L463' id='F4L463'> 463</a></div><div class='dead'><a href='#F4L464' id='F4L464'> 464</a></div><div><a href='#F4L465' id='F4L465'> 465</a></div><div class='t'><a href='#F4L466' id='F4L466'> 466</a></div><div><a href='#F4L467' id='F4L467'> 467</a></div><div class='t'><a href='#F4L468' id='F4L468'> 468</a></div><div class='dead'><a href='#F4L469' id='F4L469'> 469</a></div><div><a href='#F4L470' id='F4L470'> 470</a>
<a href='#F4L471' id='F4L471'> 471</a>
<a href='#F4L472' id='F4L472'> 472</a>
<a href='#F4L473' id='F4L473'> 473</a>
<a href='#F4L474' id='F4L474'> 474</a>
<a href='#F4L475' id='F4L475'> 475</a>
<a href='#F4L476' id='F4L476'> 476</a>
<a href='#F4L477' id='F4L477'> 477</a>
<a href='#F4L478' id='F4L478'> 478</a>
<a href='#F4L479' id='F4L479'> 479</a></div><div class='t'><a href='#F4L480' id='F4L480'> 480</a>
<a href='#F4L481' id='F4L481'> 481</a>
<a href='#F4L482' id='F4L482'> 482</a></div><div><a href='#F4L483' id='F4L483'> 483</a></div><div class='t'><a href='#F4L484' id='F4L484'> 484</a>
<a href='#F4L485' id='F4L485'> 485</a>
<a href='#F4L486' id='F4L486'> 486</a></div><div><a href='#F4L487' id='F4L487'> 487</a></div><div class='t'><a href='#F4L488' id='F4L488'> 488</a></div><div class='dead'><a href='#F4L489' id='F4L489'> 489</a></div><div><a href='#F4L490' id='F4L490'> 490</a>
<a href='#F4L491' id='F4L491'> 491</a>
<a href='#F4L492' id='F4L492'> 492</a>
<a href='#F4L493' id='F4L493'> 493</a>
<a href='#F4L494' id='F4L494'> 494</a>
<a href='#F4L495' id='F4L495'> 495</a>
<a href='#F4L496' id='F4L496'> 496</a>
<a href='#F4L497' id='F4L497'> 497</a>
<a href='#F4L498' id='F4L498'> 498</a>
<a href='#F4L499' id='F4L499'> 499</a></div><div class='t'><a href='#F4L500' id='F4L500'> 500</a>
<a href='#F4L501' id='F4L501'> 501</a>
<a href='#F4L502' id='F4L502'> 502</a>
<a href='#F4L503' id='F4L503'> 503</a>
<a href='#F4L504' id='F4L504'> 504</a>
<a href='#F4L505' id='F4L505'> 505</a>
<a href='#F4L506' id='F4L506'> 506</a></div><div><a href='#F4L507' id='F4L507'> 507</a>
<a href='#F4L508' id='F4L508'> 508</a></div><div class='t'><a href='#F4L509' id='F4L509'> 509</a></div><div class='dead'><a href='#F4L510' id='F4L510'> 510</a></div><div><a href='#F4L511' id='F4L511'> 511</a>
<a href='#F4L512' id='F4L512'> 512</a>
<a href='#F4L513' id='F4L513'> 513</a>
<a href='#F4L514' id='F4L514'> 514</a>
<a href='#F4L515' id='F4L515'> 515</a>
<a href='#F4L516' id='F4L516'> 516</a>
<a href='#F4L517' id='F4L517'> 517</a>
<a href='#F4L518' id='F4L518'> 518</a>
<a href='#F4L519' id='F4L519'> 519</a>
<a href='#F4L520' id='F4L520'> 520</a>
<a href='#F4L521' id='F4L521'> 521</a>
<a href='#F4L522' id='F4L522'> 522</a>
<a href='#F4L523' id='F4L523'> 523</a>
<a href='#F4L524' id='F4L524'> 524</a></div><div class='t'><a href='#F4L525' id='F4L525'> 525</a>
<a href='#F4L526' id='F4L526'> 526</a></div><div class='dead'><a href='#F4L527' id='F4L527'> 527</a></div><div><a href='#F4L528' id='F4L528'> 528</a></div><div class='t'><a href='#F4L529' id='F4L529'> 529</a></div><div class='dead'><a href='#F4L530' id='F4L530'> 530</a></div><div><a href='#F4L531' id='F4L531'> 531</a>
<a href='#F4L532' id='F4L532'> 532</a>
<a href='#F4L533' id='F4L533'> 533</a>
<a href='#F4L534' id='F4L534'> 534</a>
<a href='#F4L535' id='F4L535'> 535</a>
<a href='#F4L536' id='F4L536'> 536</a>
<a href='#F4L537' id='F4L537'> 537</a>
<a href='#F4L538' id='F4L538'> 538</a>
<a href='#F4L539' id='F4L539'> 539</a>
<a href='#F4L540' id='F4L540'> 540</a></div><div class='t'><a href='#F4L541' id='F4L541'> 541</a></div><div class='dead'><a href='#F4L542' id='F4L542'> 542</a></div><div><a href='#F4L543' id='F4L543'> 543</a>
<a href='#F4L544' id='F4L544'> 544</a>
<a href='#F4L545' id='F4L545'> 545</a>
<a href='#F4L546' id='F4L546'> 546</a>
<a href='#F4L547' id='F4L547'> 547</a>
<a href='#F4L548' id='F4L548'> 548</a>
<a href='#F4L549' id='F4L549'> 549</a>
<a href='#F4L550' id='F4L550'> 550</a>
<a href='#F4L551' id='F4L551'> 551</a>
<a href='#F4L552' id='F4L552'> 552</a></div><div class='t'><a href='#F4L553' id='F4L553'> 553</a></div><div class='dead'><a href='#F4L554' id='F4L554'> 554</a></div><div><a href='#F4L555' id='F4L555'> 555</a>
<a href='#F4L556' id='F4L556'> 556</a>
<a href='#F4L557' id='F4L557'> 557</a>
<a href='#F4L558' id='F4L558'> 558</a>
<a href='#F4L559' id='F4L559'> 559</a>
<a href='#F4L560' id='F4L560'> 560</a>
<a href='#F4L561' id='F4L561'> 561</a>
<a href='#F4L562' id='F4L562'> 562</a>
<a href='#F4L563' id='F4L563'> 563</a></div><div class='t'><a href='#F4L564' id='F4L564'> 564</a></div><div class='dead'><a href='#F4L565' id='F4L565'> 565</a></div><div><a href='#F4L566' id='F4L566'> 566</a>
<a href='#F4L567' id='F4L567'> 567</a>
<a href='#F4L568' id='F4L568'> 568</a>
<a href='#F4L569' id='F4L569'> 569</a>
<a href='#F4L570' id='F4L570'> 570</a>
<a href='#F4L571' id='F4L571'> 571</a>
<a href='#F4L572' id='F4L572'> 572</a>
<a href='#F4L573' id='F4L573'> 573</a>
<a href='#F4L574' id='F4L574'> 574</a>
<a href='#F4L575' id='F4L575'> 575</a></div><div class='t'><a href='#F4L576' id='F4L576'> 576</a>
<a href='#F4L577' id='F4L577'> 577</a>
<a href='#F4L578' id='F4L578'> 578</a>
<a href='#F4L579' id='F4L579'> 579</a></div><div><a href='#F4L580' id='F4L580'> 580</a></div><div class='t'><a href='#F4L581' id='F4L581'> 581</a></div><div class='dead'><a href='#F4L582' id='F4L582'> 582</a></div><div><a href='#F4L583' id='F4L583'> 583</a>
<a href='#F4L584' id='F4L584'> 584</a>
<a href='#F4L585' id='F4L585'> 585</a>
</div>			</aside>
			<code style='margin-left: 4em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Application</span><span class="hk">\</span><span class="hd">AbortException</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Application</span><span class="hk">\</span><span class="hd">Responses</span><span class="hk">\</span><span class="hd">FileResponse</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Http</span><span class="hk">\</span><span class="hd">FileUpload</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Object</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Utils</span><span class="hk">\</span><span class="hd">Image</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Utils</span><span class="hk">\</span><span class="hd">Strings</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Directory</span><span class="hk">\</span><span class="hd">Directory</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Entity</span><span class="hk">\</span><span class="hd">EmptyImage</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Entity</span><span class="hk">\</span><span class="hd">ImageEnvelope</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">\</span><span class="hd">ImageTypeException</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">\</span><span class="hd">InvalidCacheDirectoryException</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">\</span><span class="hd">UploaderException</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Files</span><span class="hk">\</span><span class="hd">ImageFile</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Image&nbsp;file&nbsp;storage<br />&nbsp;*<br />&nbsp;*&nbsp;-&nbsp;The&nbsp;images&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;regular&nbsp;files&nbsp;in&nbsp;the&nbsp;given&nbsp;`$directory`.<br />&nbsp;*&nbsp;-&nbsp;The&nbsp;files&nbsp;are&nbsp;organized&nbsp;in&nbsp;a&nbsp;2-level&nbsp;directory&nbsp;structure&nbsp;with&nbsp;maximum&nbsp;of&nbsp;256&nbsp;directories.<br />&nbsp;*&nbsp;-&nbsp;The&nbsp;directory&nbsp;tree&nbsp;is&nbsp;well&nbsp;balanced&nbsp;thanks&nbsp;to&nbsp;the&nbsp;image&nbsp;hashes&nbsp;used&nbsp;for&nbsp;the&nbsp;directory&nbsp;path&nbsp;creation.<br />&nbsp;*&nbsp;-&nbsp;The&nbsp;storage&nbsp;stores&nbsp;only&nbsp;one&nbsp;file&nbsp;even&nbsp;if&nbsp;the&nbsp;same&nbsp;image&nbsp;is&nbsp;stored&nbsp;multiple&nbsp;times,&nbsp;thus&nbsp;images&nbsp;should&nbsp;be<br />&nbsp;*&nbsp;&nbsp;&nbsp;deleted&nbsp;only&nbsp;after&nbsp;it&nbsp;is&nbsp;sure&nbsp;it&nbsp;is&nbsp;not&nbsp;referenced&nbsp;from&nbsp;other&nbsp;entities.<br />&nbsp;*&nbsp;-&nbsp;The&nbsp;image&nbsp;thumbnails&nbsp;are&nbsp;created&nbsp;on&nbsp;demand&nbsp;and&nbsp;cached&nbsp;in&nbsp;the&nbsp;`$cacheDirectory`.<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">ImageStorage&nbsp;</span><span class="hk">extends&nbsp;</span><span class="hd">Object&nbsp;</span><span class="hk">implements&nbsp;</span><span class="hd">Storage<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;directory&nbsp;to&nbsp;store&nbsp;the&nbsp;images&nbsp;in<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;Directory<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$directory</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;image&nbsp;type&nbsp;-&gt;&nbsp;file&nbsp;extension&nbsp;map<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;array<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$extensions&nbsp;</span><span class="hk">=&nbsp;array(</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">JPEG&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">'jpg'</span><span class="hk">,&nbsp;</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">PNG&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">'png'</span><span class="hk">,&nbsp;</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">GIF&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">'gif'</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;image&nbsp;type&nbsp;-&gt;&nbsp;MIME&nbsp;type&nbsp;map<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;array<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$mimeTypes&nbsp;</span><span class="hk">=&nbsp;array(</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">JPEG&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">'image/jpeg'</span><span class="hk">,&nbsp;</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">PNG&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">'image/png'</span><span class="hk">,&nbsp;</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">GIF&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">'image/gif'</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;public&nbsp;accessible&nbsp;URL&nbsp;of&nbsp;the&nbsp;cache&nbsp;directory<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$baseUrl</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;cache&nbsp;directory<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;Directory<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$cacheDirectory</span><span class="hk">;<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;the&nbsp;image&nbsp;file&nbsp;storage&nbsp;from&nbsp;the&nbsp;given&nbsp;arguments.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;&nbsp;$directory&nbsp;The&nbsp;directory&nbsp;to&nbsp;store&nbsp;the&nbsp;images&nbsp;in<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;&nbsp;$cacheDirectory<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;&nbsp;$baseUrl<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;boolean&nbsp;$tryCreateDirectories<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">$directory</span><span class="hk">,&nbsp;</span><span class="hd">$cacheDirectory</span><span class="hk">,&nbsp;</span><span class="hd">$baseUrl&nbsp;</span><span class="hk">=&nbsp;</span><span class="hs">'/cache/'</span><span class="hk">,&nbsp;</span><span class="hd">$tryCreateDirectories&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">TRUE</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">directory&nbsp;</span><span class="hk">=&nbsp;new&nbsp;</span><span class="hd">Directory</span><span class="hk">(</span><span class="hd">$directory</span><span class="hk">,&nbsp;</span><span class="hd">$tryCreateDirectories</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">cacheDirectory&nbsp;</span><span class="hk">=&nbsp;new&nbsp;</span><span class="hd">Directory</span><span class="hk">(</span><span class="hd">$cacheDirectory</span><span class="hk">,&nbsp;</span><span class="hd">$tryCreateDirectories</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">directory</span><span class="hk">-&gt;</span><span class="hd">is</span><span class="hk">(</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">cacheDirectory</span><span class="hk">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span class="hd">InvalidCacheDirectoryException</span><span class="hk">(</span><span class="hd">$cacheDirectory</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">setBaseUrl</span><span class="hk">(</span><span class="hd">$baseUrl</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;an&nbsp;image&nbsp;from&nbsp;the&nbsp;given&nbsp;file&nbsp;to&nbsp;the&nbsp;storage.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ImageFile&nbsp;$file&nbsp;The&nbsp;image&nbsp;file&nbsp;to&nbsp;add<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;boolean&nbsp;TRUE&nbsp;on&nbsp;success&nbsp;or&nbsp;FALSE&nbsp;on&nbsp;failure<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">add</span><span class="hk">(</span><span class="hd">ImageFile&nbsp;$file</span><span class="hk">,&nbsp;</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">readMeta</span><span class="hk">(</span><span class="hd">$file</span><span class="hk">-&gt;</span><span class="hd">getName</span><span class="hk">(),&nbsp;</span><span class="hd">$meta</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">copy</span><span class="hk">(</span><span class="hd">$file</span><span class="hk">-&gt;</span><span class="hd">getName</span><span class="hk">(),&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createFilename</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">));<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Reads&nbsp;the&nbsp;image&nbsp;type&nbsp;from&nbsp;the&nbsp;given&nbsp;`$filename`,&nbsp;computes&nbsp;the&nbsp;image&nbsp;hash<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;and&nbsp;store&nbsp;these&nbsp;information&nbsp;in&nbsp;the&nbsp;given&nbsp;`$meta`.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$filename&nbsp;The&nbsp;file&nbsp;to&nbsp;read&nbsp;the&nbsp;meta-data&nbsp;from<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;&nbsp;&nbsp;$meta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;object&nbsp;to&nbsp;store&nbsp;meta-data&nbsp;in<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">readMeta</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">,&nbsp;</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$info&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">getimagesize</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$meta</span><span class="hk">-&gt;</span><span class="hd">setHash</span><span class="hk">(</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">hash</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$meta</span><span class="hk">-&gt;</span><span class="hd">setWidth</span><span class="hk">(</span><span class="hd">$info</span><span class="hk">[</span><span class="hd">0</span><span class="hk">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$meta</span><span class="hk">-&gt;</span><span class="hd">setHeight</span><span class="hk">(</span><span class="hd">$info</span><span class="hk">[</span><span class="hd">1</span><span class="hk">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$meta</span><span class="hk">-&gt;</span><span class="hd">setType</span><span class="hk">(</span><span class="hd">$info</span><span class="hk">[</span><span class="hd">2</span><span class="hk">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;absolute&nbsp;file&nbsp;name&nbsp;from&nbsp;the&nbsp;given&nbsp;meta&nbsp;information.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Meta&nbsp;$meta&nbsp;The&nbsp;image&nbsp;meta&nbsp;information<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;The&nbsp;absolute&nbsp;file&nbsp;name<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">createFilename</span><span class="hk">(</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$path&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createDirectoryPath</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">-&gt;</span><span class="hd">getHash</span><span class="hk">());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$ext&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">getExtension</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">-&gt;</span><span class="hd">getType</span><span class="hk">());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$hash&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$meta</span><span class="hk">-&gt;</span><span class="hd">getHash</span><span class="hk">();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$filename&nbsp;</span><span class="hk">=&nbsp;</span><span class="hs">"</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">directory</span><span class="hs">/</span><span class="hd">$path</span><span class="hs">/</span><span class="hd">$hash</span><span class="hs">.</span><span class="hd">$ext</span><span class="hs">"</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span class="hd">Directory</span><span class="hk">(</span><span class="hd">dirname</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">));<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$filename</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Computes&nbsp;the&nbsp;SHA1&nbsp;hash&nbsp;for&nbsp;the&nbsp;given&nbsp;file.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$filename&nbsp;The&nbsp;file&nbsp;to&nbsp;compute&nbsp;the&nbsp;hash&nbsp;from<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;The&nbsp;SHA1&nbsp;hash&nbsp;of&nbsp;a&nbsp;file<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">hash</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">sha1_file</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;internal&nbsp;directory&nbsp;path&nbsp;from&nbsp;the&nbsp;given&nbsp;hash.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Some&nbsp;special&nbsp;images&nbsp;like&nbsp;the&nbsp;"Image&nbsp;Not&nbsp;Available"&nbsp;image&nbsp;are&nbsp;stored<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;in&nbsp;directories&nbsp;prefixed&nbsp;with&nbsp;an&nbsp;underscore.&nbsp;Those&nbsp;directories&nbsp;are&nbsp;not<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;fragmented&nbsp;to&nbsp;hash&nbsp;based&nbsp;structure.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;string&nbsp;$hash&nbsp;Tha&nbsp;SHA1&nbsp;hash<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">createDirectoryPath</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$hash</span><span class="hk">{</span><span class="hd">0</span><span class="hk">}&nbsp;===&nbsp;</span><span class="hs">'_'</span><span class="hk">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$hash</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hs">"</span><span class="hd">$hash</span><span class="hk">[</span><span class="hd">0</span><span class="hk">]</span><span class="hd">$hash</span><span class="hk">[</span><span class="hd">1</span><span class="hk">]</span><span class="hs">/</span><span class="hd">$hash</span><span class="hk">[</span><span class="hd">2</span><span class="hk">]</span><span class="hd">$hash</span><span class="hk">[</span><span class="hd">3</span><span class="hk">]</span><span class="hs">"</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;file&nbsp;extension&nbsp;for&nbsp;the&nbsp;given&nbsp;image&nbsp;type.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;integer&nbsp;$type&nbsp;The&nbsp;image&nbsp;type<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;file&nbsp;extension<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ImageTypeException<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">getExtension</span><span class="hk">(</span><span class="hd">$type</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">extensions</span><span class="hk">[</span><span class="hd">$type</span><span class="hk">];<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Fetches&nbsp;the&nbsp;cached&nbsp;copy&nbsp;of&nbsp;an&nbsp;image&nbsp;by&nbsp;given&nbsp;request.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">fetch</span><span class="hk">(</span><span class="hd">Request&nbsp;$request</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">checkImage</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$filename&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createCacheFilename</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">fromFile</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Fetches&nbsp;the&nbsp;original&nbsp;image&nbsp;by&nbsp;the&nbsp;given&nbsp;image&nbsp;meta&nbsp;information.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Meta&nbsp;$meta&nbsp;The&nbsp;stored&nbsp;image&nbsp;meta&nbsp;information<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Image&nbsp;The&nbsp;stored&nbsp;image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">original</span><span class="hk">(</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">fromFile</span><span class="hk">(</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createFilename</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">));<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Removes&nbsp;the&nbsp;image&nbsp;from&nbsp;the&nbsp;storage&nbsp;by&nbsp;the&nbsp;given&nbsp;image&nbsp;meta&nbsp;information.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Meta&nbsp;$meta&nbsp;The&nbsp;image&nbsp;information<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageStorage&nbsp;Fluent&nbsp;interface<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">remove</span><span class="hk">(</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">unlink</span><span class="hk">(</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createFilename</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">));<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Checks&nbsp;if&nbsp;an&nbsp;image&nbsp;of&nbsp;the&nbsp;given&nbsp;meta&nbsp;information&nbsp;is&nbsp;stored&nbsp;in&nbsp;the&nbsp;storage.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Meta&nbsp;$meta&nbsp;The&nbsp;image&nbsp;meta&nbsp;information<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;boolean&nbsp;TRUE&nbsp;if&nbsp;image&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;storage&nbsp;or&nbsp;FALSE&nbsp;otherwise<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">contains</span><span class="hk">(</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">file_exists</span><span class="hk">(</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createFilename</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">));<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Stores&nbsp;the&nbsp;given&nbsp;uploaded&nbsp;file.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;FileUpload&nbsp;$upload<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;meta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageStorage&nbsp;Fluent&nbsp;interface<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;UploaderException<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">upload</span><span class="hk">(</span><span class="hd">FileUpload&nbsp;$upload</span><span class="hk">,&nbsp;</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$upload</span><span class="hk">-&gt;</span><span class="hd">getError</span><span class="hk">())&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span class="hd">UploaderException</span><span class="hk">(</span><span class="hd">$upload</span><span class="hk">-&gt;</span><span class="hd">getError</span><span class="hk">());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$source&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$upload</span><span class="hk">-&gt;</span><span class="hd">getTemporaryFile</span><span class="hk">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">readMeta</span><span class="hk">(</span><span class="hd">$source</span><span class="hk">,&nbsp;</span><span class="hd">$meta</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$target&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createFilename</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">contains</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$image&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">fromFile</span><span class="hk">(</span><span class="hd">$source</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$image</span><span class="hk">-&gt;</span><span class="hd">resize</span><span class="hk">(</span><span class="hd">1920</span><span class="hk">,&nbsp;</span><span class="hd">1080</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$image</span><span class="hk">-&gt;</span><span class="hd">save</span><span class="hk">(</span><span class="hd">$target</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">file_exists</span><span class="hk">(</span><span class="hd">$source</span><span class="hk">))&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">unlink</span><span class="hk">(</span><span class="hd">$source</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;URL&nbsp;of&nbsp;the&nbsp;cached&nbsp;version&nbsp;of&nbsp;the&nbsp;image.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;&nbsp;The&nbsp;URL&nbsp;of&nbsp;the&nbsp;image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">link</span><span class="hk">(</span><span class="hd">Request&nbsp;$request</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">checkImage</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$filePath&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createFilePath</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hs">"</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">baseUrl$filePath</span><span class="hs">"</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;file&nbsp;download&nbsp;HTTP&nbsp;response&nbsp;which&nbsp;can&nbsp;be&nbsp;easily&nbsp;sent&nbsp;using&nbsp;the&nbsp;`send()`&nbsp;method.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;FileResponse<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">download</span><span class="hk">(</span><span class="hd">Request&nbsp;$request</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">checkImage</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$filename&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createCacheFilename</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span class="hd">FileResponse</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">,&nbsp;</span><span class="hd">basename</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">),&nbsp;</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getMeta</span><span class="hk">()-&gt;</span><span class="hd">getType</span><span class="hk">());<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;image&nbsp;directly&nbsp;to&nbsp;the&nbsp;standard&nbsp;output.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageStorage&nbsp;Fluent&nbsp;interface<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">send</span><span class="hk">(</span><span class="hd">Request&nbsp;$request</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">checkImage</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$filename&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createCacheFilename</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$fp&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">fopen</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">,&nbsp;</span><span class="hs">'r'</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">header</span><span class="hk">(</span><span class="hs">"Content-type:&nbsp;"&nbsp;</span><span class="hk">.&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">getMimeType</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getMeta</span><span class="hk">()-&gt;</span><span class="hd">getType</span><span class="hk">()));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">fpassthru</span><span class="hk">(</span><span class="hd">$fp</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">fclose</span><span class="hk">(</span><span class="hd">$fp</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Checks&nbsp;that&nbsp;the&nbsp;cached&nbsp;version&nbsp;of&nbsp;the&nbsp;image&nbsp;exists&nbsp;and&nbsp;creates&nbsp;it&nbsp;if&nbsp;not.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;&nbsp;The&nbsp;file&nbsp;name&nbsp;of&nbsp;the&nbsp;existing&nbsp;cached&nbsp;version&nbsp;of&nbsp;an&nbsp;image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">checkImage</span><span class="hk">(</span><span class="hd">Request&nbsp;$request</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$filename&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createCacheFilename</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span class="hd">file_exists</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">))&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$meta&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getMeta</span><span class="hk">();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">contains</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">))&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">//&nbsp;Use&nbsp;another&nbsp;meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$meta&nbsp;</span><span class="hk">=&nbsp;new&nbsp;</span><span class="hd">EmptyImage</span><span class="hk">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">setMeta</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$filename&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createCacheFilename</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$original&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">original</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getCrop</span><span class="hk">())&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$image&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">crop</span><span class="hk">(</span><span class="hd">$original</span><span class="hk">,&nbsp;</span><span class="hd">$request</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$image&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">resize</span><span class="hk">(</span><span class="hd">$original</span><span class="hk">,&nbsp;</span><span class="hd">$request</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span class="hd">Directory</span><span class="hk">(</span><span class="hd">dirname</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$image</span><span class="hk">-&gt;</span><span class="hd">save</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">,&nbsp;</span><span class="hd">75</span><span class="hk">,&nbsp;</span><span class="hd">$meta</span><span class="hk">-&gt;</span><span class="hd">getType</span><span class="hk">());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;file&nbsp;name&nbsp;of&nbsp;the&nbsp;cached&nbsp;version&nbsp;of&nbsp;the&nbsp;image.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;The&nbsp;file&nbsp;name&nbsp;of&nbsp;the&nbsp;cached&nbsp;version&nbsp;of&nbsp;the&nbsp;image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">createCacheFilename</span><span class="hk">(</span><span class="hd">Request&nbsp;$request</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$filePath&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createFilePath</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hs">"</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">cacheDirectory</span><span class="hs">/</span><span class="hd">$filePath</span><span class="hs">"</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Crops&nbsp;the&nbsp;given&nbsp;image&nbsp;using&nbsp;the&nbsp;given&nbsp;image&nbsp;request&nbsp;options.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Image&nbsp;&nbsp;&nbsp;$image&nbsp;&nbsp;&nbsp;The&nbsp;image&nbsp;to&nbsp;resize<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Image&nbsp;&nbsp;&nbsp;The&nbsp;image&nbsp;thumbnail<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">crop</span><span class="hk">(</span><span class="hd">Image&nbsp;$image</span><span class="hk">,&nbsp;</span><span class="hd">Request&nbsp;$request</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getDimensions</span><span class="hk">()&nbsp;===&nbsp;</span><span class="hd">Request</span><span class="hk">::</span><span class="hd">ORIGINAL</span><span class="hk">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$image</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list(</span><span class="hd">$width</span><span class="hk">,&nbsp;</span><span class="hd">$height</span><span class="hk">)&nbsp;=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">processDimensions</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getDimensions</span><span class="hk">());<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$resizeWidth&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$width</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$resizeHeight&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$height</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$originalWidth&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getMeta</span><span class="hk">()-&gt;</span><span class="hd">getWidth</span><span class="hk">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$originalHeight&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getMeta</span><span class="hk">()-&gt;</span><span class="hd">getHeight</span><span class="hk">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$originalLandscape&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$originalWidth&nbsp;</span><span class="hk">&gt;&nbsp;</span><span class="hd">$originalHeight</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$cropLandscape&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$width&nbsp;</span><span class="hk">&gt;&nbsp;</span><span class="hd">$height</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$equals&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$width&nbsp;</span><span class="hk">===&nbsp;</span><span class="hd">$height</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$originalLandscape</span><span class="hk">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$cropLandscape</span><span class="hk">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$coefficient&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$originalHeight&nbsp;</span><span class="hk">/&nbsp;</span><span class="hd">$height</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$scaledWidth&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">round</span><span class="hk">(</span><span class="hd">$originalWidth&nbsp;</span><span class="hk">/&nbsp;</span><span class="hd">$coefficient</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$left&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">round</span><span class="hk">((</span><span class="hd">$scaledWidth&nbsp;</span><span class="hk">-&nbsp;</span><span class="hd">$width</span><span class="hk">)&nbsp;/&nbsp;</span><span class="hd">2</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$top&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">0</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$scaledWidth&nbsp;</span><span class="hk">&lt;&nbsp;</span><span class="hd">$width</span><span class="hk">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$coefficient&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$originalWidth&nbsp;</span><span class="hk">/&nbsp;</span><span class="hd">$width</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$scaledHeight&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">round</span><span class="hk">(</span><span class="hd">$originalHeight&nbsp;</span><span class="hk">/&nbsp;</span><span class="hd">$coefficient</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$left&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">0</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$top&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">round</span><span class="hk">((</span><span class="hd">$scaledHeight&nbsp;</span><span class="hk">-&nbsp;</span><span class="hd">$height</span><span class="hk">)&nbsp;/&nbsp;</span><span class="hd">2</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$coefficient&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$originalHeight&nbsp;</span><span class="hk">/&nbsp;</span><span class="hd">$height</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$scaledWidth&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">round</span><span class="hk">(</span><span class="hd">$originalWidth&nbsp;</span><span class="hk">/&nbsp;</span><span class="hd">$coefficient</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$left&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">round</span><span class="hk">((</span><span class="hd">$scaledWidth&nbsp;</span><span class="hk">-&nbsp;</span><span class="hd">$width</span><span class="hk">)&nbsp;/&nbsp;</span><span class="hd">2</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$top&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">0</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$cropLandscape&nbsp;</span><span class="hk">||&nbsp;</span><span class="hd">$equals</span><span class="hk">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$coefficient&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$originalWidth&nbsp;</span><span class="hk">/&nbsp;</span><span class="hd">$width</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$scaledHeight&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">round</span><span class="hk">(</span><span class="hd">$originalHeight&nbsp;</span><span class="hk">/&nbsp;</span><span class="hd">$coefficient</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$left&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">0</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$top&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">round</span><span class="hk">((</span><span class="hd">$scaledHeight&nbsp;</span><span class="hk">-&nbsp;</span><span class="hd">$height</span><span class="hk">)&nbsp;/&nbsp;</span><span class="hd">2</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$coefficient&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$originalHeight&nbsp;</span><span class="hk">/&nbsp;</span><span class="hd">$height</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$scaledWidth&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">round</span><span class="hk">(</span><span class="hd">$originalWidth&nbsp;</span><span class="hk">/&nbsp;</span><span class="hd">$coefficient</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$left&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">round</span><span class="hk">((</span><span class="hd">$scaledWidth&nbsp;</span><span class="hk">-&nbsp;</span><span class="hd">$width</span><span class="hk">)&nbsp;/&nbsp;</span><span class="hd">2</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$top&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">0</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$image</span><span class="hk">-&gt;</span><span class="hd">resize</span><span class="hk">(</span><span class="hd">$resizeWidth</span><span class="hk">,&nbsp;</span><span class="hd">$resizeHeight</span><span class="hk">,&nbsp;</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">FILL</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$image</span><span class="hk">-&gt;</span><span class="hd">crop</span><span class="hk">(</span><span class="hd">$left</span><span class="hk">,&nbsp;</span><span class="hd">$top</span><span class="hk">,&nbsp;</span><span class="hd">$width</span><span class="hk">,&nbsp;</span><span class="hd">$height</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$image</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Resizes&nbsp;the&nbsp;given&nbsp;image&nbsp;to&nbsp;the&nbsp;given&nbsp;dimensions&nbsp;using&nbsp;given&nbsp;flags.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Image&nbsp;&nbsp;&nbsp;$image&nbsp;&nbsp;&nbsp;The&nbsp;image&nbsp;to&nbsp;resize<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Image&nbsp;&nbsp;&nbsp;The&nbsp;image&nbsp;thumbnail<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">resize</span><span class="hk">(</span><span class="hd">Image&nbsp;$image</span><span class="hk">,&nbsp;</span><span class="hd">Request&nbsp;$request</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getDimensions</span><span class="hk">()&nbsp;===&nbsp;</span><span class="hd">Request</span><span class="hk">::</span><span class="hd">ORIGINAL</span><span class="hk">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$image</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list(</span><span class="hd">$width</span><span class="hk">,&nbsp;</span><span class="hd">$height</span><span class="hk">)&nbsp;=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">processDimensions</span><span class="hk">(</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getDimensions</span><span class="hk">());<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$image</span><span class="hk">-&gt;</span><span class="hd">resize</span><span class="hk">(</span><span class="hd">$width</span><span class="hk">,&nbsp;</span><span class="hd">$height</span><span class="hk">,&nbsp;</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getFlags</span><span class="hk">());<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;part&nbsp;of&nbsp;the&nbsp;image&nbsp;filename&nbsp;relative&nbsp;to&nbsp;the&nbsp;cache&nbsp;directory.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">createFilePath</span><span class="hk">(</span><span class="hd">Request&nbsp;$request</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$dimensions&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getDimensions</span><span class="hk">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$flags&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getFlags</span><span class="hk">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$crop&nbsp;</span><span class="hk">=&nbsp;(int)&nbsp;</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getCrop</span><span class="hk">();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$meta&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$request</span><span class="hk">-&gt;</span><span class="hd">getMeta</span><span class="hk">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$ext&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">getExtension</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">-&gt;</span><span class="hd">getType</span><span class="hk">());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$baseFilePath&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createCacheDirectoryPath</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">-&gt;</span><span class="hd">getHash</span><span class="hk">());<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hs">"</span><span class="hd">$baseFilePath</span><span class="hs">.</span><span class="hd">$dimensions</span><span class="hs">.</span><span class="hd">$flags</span><span class="hs">.</span><span class="hd">$crop</span><span class="hs">.</span><span class="hd">$ext</span><span class="hs">"</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;the&nbsp;given&nbsp;dimensions&nbsp;string&nbsp;for&nbsp;the&nbsp;image&nbsp;width&nbsp;and&nbsp;height.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;string&nbsp;$dimensions&nbsp;The&nbsp;dimensions&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;array&nbsp;&nbsp;The&nbsp;width&nbsp;and&nbsp;height&nbsp;of&nbsp;the&nbsp;image&nbsp;in&nbsp;pixels<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">processDimensions</span><span class="hk">(</span><span class="hd">$dimensions</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">strpos</span><span class="hk">(</span><span class="hd">$dimensions</span><span class="hk">,&nbsp;</span><span class="hs">'x'</span><span class="hk">)&nbsp;!==&nbsp;</span><span class="hd">FALSE</span><span class="hk">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list(</span><span class="hd">$width</span><span class="hk">,&nbsp;</span><span class="hd">$height</span><span class="hk">)&nbsp;=&nbsp;</span><span class="hd">explode</span><span class="hk">(</span><span class="hs">'x'</span><span class="hk">,&nbsp;</span><span class="hd">$dimensions</span><span class="hk">);&nbsp;</span><span class="hc">//&nbsp;different&nbsp;dimensions,&nbsp;eg.&nbsp;"210x150"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$width&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">intval</span><span class="hk">(</span><span class="hd">$width</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$height&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">intval</span><span class="hk">(</span><span class="hd">$height</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$width&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">intval</span><span class="hk">(</span><span class="hd">$dimensions</span><span class="hk">);&nbsp;</span><span class="hc">//&nbsp;same&nbsp;dimensions,&nbsp;eg.&nbsp;"210"&nbsp;=&gt;&nbsp;210x210<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$height&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$width</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;array(</span><span class="hd">$width</span><span class="hk">,&nbsp;</span><span class="hd">$height</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;internal&nbsp;directory&nbsp;path&nbsp;from&nbsp;the&nbsp;given&nbsp;hash.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Some&nbsp;special&nbsp;images&nbsp;like&nbsp;the&nbsp;"Image&nbsp;Not&nbsp;Available"&nbsp;image&nbsp;are&nbsp;stored<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;in&nbsp;directories&nbsp;prefixed&nbsp;with&nbsp;an&nbsp;underscore.&nbsp;Those&nbsp;directories&nbsp;are&nbsp;not<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;fragmented&nbsp;to&nbsp;hash&nbsp;based&nbsp;structure.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;string&nbsp;$hash&nbsp;Tha&nbsp;SHA1&nbsp;hash<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">createCacheDirectoryPath</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$hash</span><span class="hk">{</span><span class="hd">0</span><span class="hk">}&nbsp;===&nbsp;</span><span class="hs">'_'</span><span class="hk">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hs">"</span><span class="hd">$hash</span><span class="hs">/</span><span class="hd">$hash</span><span class="hs">"</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hs">"</span><span class="hd">$hash</span><span class="hk">[</span><span class="hd">0</span><span class="hk">]</span><span class="hd">$hash</span><span class="hk">[</span><span class="hd">1</span><span class="hk">]</span><span class="hs">/</span><span class="hd">$hash</span><span class="hk">[</span><span class="hd">2</span><span class="hk">]</span><span class="hd">$hash</span><span class="hk">[</span><span class="hd">3</span><span class="hk">]</span><span class="hs">"&nbsp;</span><span class="hk">.&nbsp;</span><span class="hs">'/'&nbsp;</span><span class="hk">.&nbsp;</span><span class="hd">$hash</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;image&nbsp;MIME&nbsp;type&nbsp;according&nbsp;to&nbsp;the&nbsp;given&nbsp;image&nbsp;type.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$imageType&nbsp;Image&nbsp;type<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">protected&nbsp;function&nbsp;</span><span class="hd">getMimeType</span><span class="hk">(</span><span class="hd">$imageType</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">mimeTypes</span><span class="hk">[</span><span class="hd">$imageType</span><span class="hk">];<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;original&nbsp;stored&nbsp;image&nbsp;filename.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;$meta&nbsp;Image&nbsp;meta&nbsp;information<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">file</span><span class="hk">(</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">createFilename</span><span class="hk">(</span><span class="hd">$meta</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;public&nbsp;accessible&nbsp;cache&nbsp;directory&nbsp;URL.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getBaseUrl</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">baseUrl</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;public&nbsp;accessible&nbsp;cache&nbsp;directory&nbsp;URL.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$baseUrl<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;$this<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">protected&nbsp;function&nbsp;</span><span class="hd">setBaseUrl</span><span class="hk">(</span><span class="hd">$baseUrl</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span class="hd">Strings</span><span class="hk">::</span><span class="hd">endsWith</span><span class="hk">(</span><span class="hd">$baseUrl</span><span class="hk">,&nbsp;</span><span class="hs">'/'</span><span class="hk">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$baseUrl&nbsp;</span><span class="hk">.=&nbsp;</span><span class="hs">'/'</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">baseUrl&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$baseUrl</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F5" class="toggle">ImageStore/Exceptions/ImageTypeException.php</a></td>
		</tr>
		</table>

		<div class="code" id="F5">
		<div>
			<aside>
			<div><a href='#F5L1' id='F5L1'>  1</a>
<a href='#F5L2' id='F5L2'>  2</a>
<a href='#F5L3' id='F5L3'>  3</a>
<a href='#F5L4' id='F5L4'>  4</a>
<a href='#F5L5' id='F5L5'>  5</a>
<a href='#F5L6' id='F5L6'>  6</a>
<a href='#F5L7' id='F5L7'>  7</a>
<a href='#F5L8' id='F5L8'>  8</a>
<a href='#F5L9' id='F5L9'>  9</a>
<a href='#F5L10' id='F5L10'> 10</a>
<a href='#F5L11' id='F5L11'> 11</a></div><div class='t'><a href='#F5L12' id='F5L12'> 12</a></div><div><a href='#F5L13' id='F5L13'> 13</a>
<a href='#F5L14' id='F5L14'> 14</a>
<a href='#F5L15' id='F5L15'> 15</a>
<a href='#F5L16' id='F5L16'> 16</a>
<a href='#F5L17' id='F5L17'> 17</a>
<a href='#F5L18' id='F5L18'> 18</a></div><div class='t'><a href='#F5L19' id='F5L19'> 19</a>
<a href='#F5L20' id='F5L20'> 20</a>
<a href='#F5L21' id='F5L21'> 21</a></div><div><a href='#F5L22' id='F5L22'> 22</a>
<a href='#F5L23' id='F5L23'> 23</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">InvalidArgumentException</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Invalid&nbsp;image&nbsp;type&nbsp;exception<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">ImageTypeException&nbsp;</span><span class="hk">extends&nbsp;</span><span class="hd">InvalidArgumentException<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$type<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">$type</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$message&nbsp;</span><span class="hk">=&nbsp;</span><span class="hs">'The&nbsp;image&nbsp;type&nbsp;%s&nbsp;is&nbsp;not&nbsp;supported,&nbsp;it&nbsp;must&nbsp;be&nbsp;one&nbsp;of&nbsp;Image::JPEG,&nbsp;Image::PNG&nbsp;or&nbsp;Image::GIF.'</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">parent</span><span class="hk">::</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">sprintf</span><span class="hk">(</span><span class="hd">$message</span><span class="hk">,&nbsp;</span><span class="hd">var_export</span><span class="hk">(</span><span class="hd">$type</span><span class="hk">,&nbsp;</span><span class="hd">TRUE</span><span class="hk">)));<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F6" class="toggle">ImageStore/Exceptions/HashException.php</a></td>
		</tr>
		</table>

		<div class="code" id="F6">
		<div>
			<aside>
			<div><a href='#F6L1' id='F6L1'>  1</a>
<a href='#F6L2' id='F6L2'>  2</a>
<a href='#F6L3' id='F6L3'>  3</a>
<a href='#F6L4' id='F6L4'>  4</a>
<a href='#F6L5' id='F6L5'>  5</a>
<a href='#F6L6' id='F6L6'>  6</a>
<a href='#F6L7' id='F6L7'>  7</a>
<a href='#F6L8' id='F6L8'>  8</a>
<a href='#F6L9' id='F6L9'>  9</a>
<a href='#F6L10' id='F6L10'> 10</a>
<a href='#F6L11' id='F6L11'> 11</a></div><div class='t'><a href='#F6L12' id='F6L12'> 12</a></div><div><a href='#F6L13' id='F6L13'> 13</a>
<a href='#F6L14' id='F6L14'> 14</a>
<a href='#F6L15' id='F6L15'> 15</a>
<a href='#F6L16' id='F6L16'> 16</a>
<a href='#F6L17' id='F6L17'> 17</a>
<a href='#F6L18' id='F6L18'> 18</a></div><div class='t'><a href='#F6L19' id='F6L19'> 19</a></div><div><a href='#F6L20' id='F6L20'> 20</a></div><div class='t'><a href='#F6L21' id='F6L21'> 21</a>
<a href='#F6L22' id='F6L22'> 22</a></div><div><a href='#F6L23' id='F6L23'> 23</a>
<a href='#F6L24' id='F6L24'> 24</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">Exception</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Invalid&nbsp;hash&nbsp;exception<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">HashException&nbsp;</span><span class="hk">extends&nbsp;</span><span class="hd">Exception<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$hash<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$message&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">sprintf</span><span class="hk">(</span><span class="hs">'The&nbsp;image&nbsp;hash&nbsp;is&nbsp;invalid.&nbsp;It&nbsp;is&nbsp;required&nbsp;to&nbsp;be&nbsp;a&nbsp;SHA1&nbsp;hash&nbsp;but&nbsp;%s&nbsp;given.'</span><span class="hk">,&nbsp;</span><span class="hd">var_export</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">,&nbsp;</span><span class="hd">TRUE</span><span class="hk">));<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">parent</span><span class="hk">::</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">$message</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F7" class="toggle">ImageStore/Exceptions/InvalidCacheDirectoryException.php</a></td>
		</tr>
		</table>

		<div class="code" id="F7">
		<div>
			<aside>
			<div><a href='#F7L1' id='F7L1'>  1</a>
<a href='#F7L2' id='F7L2'>  2</a>
<a href='#F7L3' id='F7L3'>  3</a>
<a href='#F7L4' id='F7L4'>  4</a>
<a href='#F7L5' id='F7L5'>  5</a>
<a href='#F7L6' id='F7L6'>  6</a>
<a href='#F7L7' id='F7L7'>  7</a>
<a href='#F7L8' id='F7L8'>  8</a>
<a href='#F7L9' id='F7L9'>  9</a>
<a href='#F7L10' id='F7L10'> 10</a>
<a href='#F7L11' id='F7L11'> 11</a>
<a href='#F7L12' id='F7L12'> 12</a>
<a href='#F7L13' id='F7L13'> 13</a></div><div class='t'><a href='#F7L14' id='F7L14'> 14</a></div><div><a href='#F7L15' id='F7L15'> 15</a>
<a href='#F7L16' id='F7L16'> 16</a>
<a href='#F7L17' id='F7L17'> 17</a>
<a href='#F7L18' id='F7L18'> 18</a>
<a href='#F7L19' id='F7L19'> 19</a>
<a href='#F7L20' id='F7L20'> 20</a>
<a href='#F7L21' id='F7L21'> 21</a></div><div class='t'><a href='#F7L22' id='F7L22'> 22</a>
<a href='#F7L23' id='F7L23'> 23</a></div><div><a href='#F7L24' id='F7L24'> 24</a>
<a href='#F7L25' id='F7L25'> 25</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">InvalidArgumentException</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Invalid&nbsp;cache&nbsp;directory&nbsp;exception<br />&nbsp;*<br />&nbsp;*&nbsp;It's&nbsp;thrown&nbsp;when&nbsp;user&nbsp;attempts&nbsp;to&nbsp;use&nbsp;the&nbsp;same&nbsp;directory&nbsp;for&nbsp;the&nbsp;storage&nbsp;AND&nbsp;the&nbsp;cache.<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">InvalidCacheDirectoryException&nbsp;</span><span class="hk">extends&nbsp;</span><span class="hd">InvalidArgumentException<br /></span><span class="hk">{<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$directory<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">$directory</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">parent</span><span class="hk">::</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">sprintf</span><span class="hk">(</span><span class="hs">'You&nbsp;cannot&nbsp;use&nbsp;the&nbsp;same&nbsp;directory&nbsp;for&nbsp;the&nbsp;image&nbsp;cache&nbsp;as&nbsp;for&nbsp;the&nbsp;storage.&nbsp;Path:&nbsp;(%s)'</span><span class="hk">,&nbsp;</span><span class="hd">var_export</span><span class="hk">(</span><span class="hd">$directory</span><span class="hk">,&nbsp;</span><span class="hd">TRUE</span><span class="hk">)));<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F8" class="toggle">ImageStore/Exceptions/UploaderException.php</a></td>
		</tr>
		</table>

		<div class="code" id="F8">
		<div>
			<aside>
			<div><a href='#F8L1' id='F8L1'>  1</a>
<a href='#F8L2' id='F8L2'>  2</a>
<a href='#F8L3' id='F8L3'>  3</a>
<a href='#F8L4' id='F8L4'>  4</a>
<a href='#F8L5' id='F8L5'>  5</a>
<a href='#F8L6' id='F8L6'>  6</a>
<a href='#F8L7' id='F8L7'>  7</a>
<a href='#F8L8' id='F8L8'>  8</a>
<a href='#F8L9' id='F8L9'>  9</a>
<a href='#F8L10' id='F8L10'> 10</a>
<a href='#F8L11' id='F8L11'> 11</a></div><div class='t'><a href='#F8L12' id='F8L12'> 12</a></div><div><a href='#F8L13' id='F8L13'> 13</a>
<a href='#F8L14' id='F8L14'> 14</a>
<a href='#F8L15' id='F8L15'> 15</a>
<a href='#F8L16' id='F8L16'> 16</a>
<a href='#F8L17' id='F8L17'> 17</a>
<a href='#F8L18' id='F8L18'> 18</a>
<a href='#F8L19' id='F8L19'> 19</a>
<a href='#F8L20' id='F8L20'> 20</a>
<a href='#F8L21' id='F8L21'> 21</a>
<a href='#F8L22' id='F8L22'> 22</a>
<a href='#F8L23' id='F8L23'> 23</a>
<a href='#F8L24' id='F8L24'> 24</a>
<a href='#F8L25' id='F8L25'> 25</a>
<a href='#F8L26' id='F8L26'> 26</a>
<a href='#F8L27' id='F8L27'> 27</a>
<a href='#F8L28' id='F8L28'> 28</a>
<a href='#F8L29' id='F8L29'> 29</a>
<a href='#F8L30' id='F8L30'> 30</a>
<a href='#F8L31' id='F8L31'> 31</a>
<a href='#F8L32' id='F8L32'> 32</a>
<a href='#F8L33' id='F8L33'> 33</a>
<a href='#F8L34' id='F8L34'> 34</a>
<a href='#F8L35' id='F8L35'> 35</a></div><div class='t'><a href='#F8L36' id='F8L36'> 36</a>
<a href='#F8L37' id='F8L37'> 37</a></div><div><a href='#F8L38' id='F8L38'> 38</a>
<a href='#F8L39' id='F8L39'> 39</a>
<a href='#F8L40' id='F8L40'> 40</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">RuntimeException</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Image&nbsp;upload&nbsp;error&nbsp;exception<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">UploaderException&nbsp;</span><span class="hk">extends&nbsp;</span><span class="hd">RuntimeException<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Upload&nbsp;error&nbsp;code&nbsp;-&gt;&nbsp;error&nbsp;message&nbsp;map<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$messages&nbsp;</span><span class="hk">=&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">0&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">"There&nbsp;is&nbsp;no&nbsp;error,&nbsp;the&nbsp;file&nbsp;uploaded&nbsp;with&nbsp;success"</span><span class="hk">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">1&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">"The&nbsp;uploaded&nbsp;file&nbsp;exceeds&nbsp;the&nbsp;upload_max_filesize&nbsp;directive&nbsp;in&nbsp;php.ini"</span><span class="hk">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">2&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">"The&nbsp;uploaded&nbsp;file&nbsp;exceeds&nbsp;the&nbsp;MAX_FILE_SIZE&nbsp;directive&nbsp;that&nbsp;was&nbsp;specified&nbsp;in&nbsp;the&nbsp;HTML&nbsp;form"</span><span class="hk">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">3&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">"The&nbsp;uploaded&nbsp;file&nbsp;was&nbsp;only&nbsp;partially&nbsp;uploaded"</span><span class="hk">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">4&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">"No&nbsp;file&nbsp;was&nbsp;uploaded"</span><span class="hk">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">6&nbsp;</span><span class="hk">=&gt;&nbsp;</span><span class="hs">"Missing&nbsp;a&nbsp;temporary&nbsp;folder"</span><span class="hk">,<br />&nbsp;&nbsp;&nbsp;&nbsp;];<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;the&nbsp;upload&nbsp;error&nbsp;exception&nbsp;using&nbsp;the&nbsp;given&nbsp;upload&nbsp;error&nbsp;code.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$code<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">$code</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">parent</span><span class="hk">::</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">messages</span><span class="hk">[</span><span class="hd">$code</span><span class="hk">],&nbsp;</span><span class="hd">$code</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F9" class="toggle">ImageStore/Exceptions/DirectoryException.php</a></td>
		</tr>
		</table>

		<div class="code" id="F9">
		<div>
			<aside>
			<div><a href='#F9L1' id='F9L1'>  1</a>
<a href='#F9L2' id='F9L2'>  2</a>
<a href='#F9L3' id='F9L3'>  3</a>
<a href='#F9L4' id='F9L4'>  4</a>
<a href='#F9L5' id='F9L5'>  5</a>
<a href='#F9L6' id='F9L6'>  6</a>
<a href='#F9L7' id='F9L7'>  7</a>
<a href='#F9L8' id='F9L8'>  8</a>
<a href='#F9L9' id='F9L9'>  9</a>
<a href='#F9L10' id='F9L10'> 10</a>
<a href='#F9L11' id='F9L11'> 11</a></div><div class='t'><a href='#F9L12' id='F9L12'> 12</a></div><div><a href='#F9L13' id='F9L13'> 13</a>
<a href='#F9L14' id='F9L14'> 14</a>
<a href='#F9L15' id='F9L15'> 15</a>
<a href='#F9L16' id='F9L16'> 16</a>
<a href='#F9L17' id='F9L17'> 17</a>
<a href='#F9L18' id='F9L18'> 18</a>
<a href='#F9L19' id='F9L19'> 19</a></div><div class='t'><a href='#F9L20' id='F9L20'> 20</a>
<a href='#F9L21' id='F9L21'> 21</a></div><div><a href='#F9L22' id='F9L22'> 22</a>
<a href='#F9L23' id='F9L23'> 23</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">InvalidArgumentException</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Directory&nbsp;exception<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">DirectoryException&nbsp;</span><span class="hk">extends&nbsp;</span><span class="hd">InvalidArgumentException<br /></span><span class="hk">{<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$directory<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">$directory</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">parent</span><span class="hk">::</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">sprintf</span><span class="hk">(</span><span class="hs">'Directory&nbsp;"%s"&nbsp;does&nbsp;not&nbsp;exist&nbsp;and&nbsp;cannot&nbsp;be&nbsp;created&nbsp;or&nbsp;it&nbsp;is&nbsp;not&nbsp;writable.'</span><span class="hk">,&nbsp;</span><span class="hd">var_export</span><span class="hk">(</span><span class="hd">$directory</span><span class="hk">,&nbsp;</span><span class="hd">TRUE</span><span class="hk">)));<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F10" class="toggle">ImageStore/Exceptions/ImageFileException.php</a></td>
		</tr>
		</table>

		<div class="code" id="F10">
		<div>
			<aside>
			<div><a href='#F10L1' id='F10L1'>  1</a>
<a href='#F10L2' id='F10L2'>  2</a>
<a href='#F10L3' id='F10L3'>  3</a>
<a href='#F10L4' id='F10L4'>  4</a>
<a href='#F10L5' id='F10L5'>  5</a>
<a href='#F10L6' id='F10L6'>  6</a>
<a href='#F10L7' id='F10L7'>  7</a>
<a href='#F10L8' id='F10L8'>  8</a>
<a href='#F10L9' id='F10L9'>  9</a>
<a href='#F10L10' id='F10L10'> 10</a>
<a href='#F10L11' id='F10L11'> 11</a></div><div class='t'><a href='#F10L12' id='F10L12'> 12</a></div><div><a href='#F10L13' id='F10L13'> 13</a>
<a href='#F10L14' id='F10L14'> 14</a>
<a href='#F10L15' id='F10L15'> 15</a>
<a href='#F10L16' id='F10L16'> 16</a>
<a href='#F10L17' id='F10L17'> 17</a>
<a href='#F10L18' id='F10L18'> 18</a></div><div class='t'><a href='#F10L19' id='F10L19'> 19</a>
<a href='#F10L20' id='F10L20'> 20</a></div><div><a href='#F10L21' id='F10L21'> 21</a>
<a href='#F10L22' id='F10L22'> 22</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">InvalidArgumentException</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Invalid&nbsp;image&nbsp;type&nbsp;exception<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">ImageFileException&nbsp;</span><span class="hk">extends&nbsp;</span><span class="hd">InvalidArgumentException<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$filename<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">parent</span><span class="hk">::</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">sprintf</span><span class="hk">(</span><span class="hs">'File&nbsp;%s&nbsp;does&nbsp;not&nbsp;exist&nbsp;or&nbsp;it&nbsp;is&nbsp;not&nbsp;an&nbsp;image.'</span><span class="hk">,&nbsp;</span><span class="hd">var_export</span><span class="hk">(</span><span class="hd">$filename</span><span class="hk">,&nbsp;</span><span class="hd">TRUE</span><span class="hk">)));<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F11" class="toggle">ImageStore/Macro/ImageMacro.php</a></td>
		</tr>
		</table>

		<div class="code" id="F11">
		<div>
			<aside>
			<div><a href='#F11L1' id='F11L1'>   1</a>
<a href='#F11L2' id='F11L2'>   2</a>
<a href='#F11L3' id='F11L3'>   3</a>
<a href='#F11L4' id='F11L4'>   4</a>
<a href='#F11L5' id='F11L5'>   5</a>
<a href='#F11L6' id='F11L6'>   6</a>
<a href='#F11L7' id='F11L7'>   7</a>
<a href='#F11L8' id='F11L8'>   8</a>
<a href='#F11L9' id='F11L9'>   9</a>
<a href='#F11L10' id='F11L10'>  10</a>
<a href='#F11L11' id='F11L11'>  11</a>
<a href='#F11L12' id='F11L12'>  12</a>
<a href='#F11L13' id='F11L13'>  13</a>
<a href='#F11L14' id='F11L14'>  14</a></div><div class='t'><a href='#F11L15' id='F11L15'>  15</a></div><div><a href='#F11L16' id='F11L16'>  16</a>
<a href='#F11L17' id='F11L17'>  17</a>
<a href='#F11L18' id='F11L18'>  18</a>
<a href='#F11L19' id='F11L19'>  19</a>
<a href='#F11L20' id='F11L20'>  20</a>
<a href='#F11L21' id='F11L21'>  21</a>
<a href='#F11L22' id='F11L22'>  22</a>
<a href='#F11L23' id='F11L23'>  23</a>
<a href='#F11L24' id='F11L24'>  24</a>
<a href='#F11L25' id='F11L25'>  25</a></div><div class='t'><a href='#F11L26' id='F11L26'>  26</a>
<a href='#F11L27' id='F11L27'>  27</a>
<a href='#F11L28' id='F11L28'>  28</a></div><div><a href='#F11L29' id='F11L29'>  29</a>
<a href='#F11L30' id='F11L30'>  30</a>
<a href='#F11L31' id='F11L31'>  31</a>
<a href='#F11L32' id='F11L32'>  32</a>
<a href='#F11L33' id='F11L33'>  33</a>
<a href='#F11L34' id='F11L34'>  34</a>
<a href='#F11L35' id='F11L35'>  35</a></div><div class='t'><a href='#F11L36' id='F11L36'>  36</a>
<a href='#F11L37' id='F11L37'>  37</a>
<a href='#F11L38' id='F11L38'>  38</a>
<a href='#F11L39' id='F11L39'>  39</a>
<a href='#F11L40' id='F11L40'>  40</a></div><div><a href='#F11L41' id='F11L41'>  41</a>
<a href='#F11L42' id='F11L42'>  42</a>
<a href='#F11L43' id='F11L43'>  43</a>
<a href='#F11L44' id='F11L44'>  44</a>
<a href='#F11L45' id='F11L45'>  45</a>
<a href='#F11L46' id='F11L46'>  46</a>
<a href='#F11L47' id='F11L47'>  47</a>
<a href='#F11L48' id='F11L48'>  48</a>
<a href='#F11L49' id='F11L49'>  49</a>
<a href='#F11L50' id='F11L50'>  50</a>
<a href='#F11L51' id='F11L51'>  51</a></div><div class='t'><a href='#F11L52' id='F11L52'>  52</a></div><div class='dead'><a href='#F11L53' id='F11L53'>  53</a></div><div><a href='#F11L54' id='F11L54'>  54</a>
<a href='#F11L55' id='F11L55'>  55</a>
<a href='#F11L56' id='F11L56'>  56</a>
<a href='#F11L57' id='F11L57'>  57</a>
<a href='#F11L58' id='F11L58'>  58</a>
<a href='#F11L59' id='F11L59'>  59</a>
<a href='#F11L60' id='F11L60'>  60</a>
<a href='#F11L61' id='F11L61'>  61</a>
<a href='#F11L62' id='F11L62'>  62</a>
<a href='#F11L63' id='F11L63'>  63</a>
<a href='#F11L64' id='F11L64'>  64</a></div><div class='t'><a href='#F11L65' id='F11L65'>  65</a></div><div class='dead'><a href='#F11L66' id='F11L66'>  66</a></div><div><a href='#F11L67' id='F11L67'>  67</a>
<a href='#F11L68' id='F11L68'>  68</a>
<a href='#F11L69' id='F11L69'>  69</a>
<a href='#F11L70' id='F11L70'>  70</a>
<a href='#F11L71' id='F11L71'>  71</a>
<a href='#F11L72' id='F11L72'>  72</a>
<a href='#F11L73' id='F11L73'>  73</a>
<a href='#F11L74' id='F11L74'>  74</a>
<a href='#F11L75' id='F11L75'>  75</a>
<a href='#F11L76' id='F11L76'>  76</a>
<a href='#F11L77' id='F11L77'>  77</a></div><div class='t'><a href='#F11L78' id='F11L78'>  78</a></div><div class='dead'><a href='#F11L79' id='F11L79'>  79</a></div><div><a href='#F11L80' id='F11L80'>  80</a>
<a href='#F11L81' id='F11L81'>  81</a>
<a href='#F11L82' id='F11L82'>  82</a>
<a href='#F11L83' id='F11L83'>  83</a>
<a href='#F11L84' id='F11L84'>  84</a>
<a href='#F11L85' id='F11L85'>  85</a>
<a href='#F11L86' id='F11L86'>  86</a>
<a href='#F11L87' id='F11L87'>  87</a>
<a href='#F11L88' id='F11L88'>  88</a>
<a href='#F11L89' id='F11L89'>  89</a>
<a href='#F11L90' id='F11L90'>  90</a></div><div class='t'><a href='#F11L91' id='F11L91'>  91</a></div><div class='dead'><a href='#F11L92' id='F11L92'>  92</a></div><div><a href='#F11L93' id='F11L93'>  93</a>
<a href='#F11L94' id='F11L94'>  94</a>
<a href='#F11L95' id='F11L95'>  95</a>
<a href='#F11L96' id='F11L96'>  96</a>
<a href='#F11L97' id='F11L97'>  97</a>
<a href='#F11L98' id='F11L98'>  98</a>
<a href='#F11L99' id='F11L99'>  99</a>
<a href='#F11L100' id='F11L100'> 100</a>
<a href='#F11L101' id='F11L101'> 101</a>
<a href='#F11L102' id='F11L102'> 102</a>
<a href='#F11L103' id='F11L103'> 103</a></div><div class='t'><a href='#F11L104' id='F11L104'> 104</a></div><div class='dead'><a href='#F11L105' id='F11L105'> 105</a></div><div><a href='#F11L106' id='F11L106'> 106</a>
<a href='#F11L107' id='F11L107'> 107</a>
<a href='#F11L108' id='F11L108'> 108</a>
<a href='#F11L109' id='F11L109'> 109</a>
<a href='#F11L110' id='F11L110'> 110</a>
<a href='#F11L111' id='F11L111'> 111</a>
<a href='#F11L112' id='F11L112'> 112</a>
<a href='#F11L113' id='F11L113'> 113</a>
<a href='#F11L114' id='F11L114'> 114</a>
<a href='#F11L115' id='F11L115'> 115</a>
<a href='#F11L116' id='F11L116'> 116</a></div><div class='t'><a href='#F11L117' id='F11L117'> 117</a></div><div class='dead'><a href='#F11L118' id='F11L118'> 118</a></div><div><a href='#F11L119' id='F11L119'> 119</a>
<a href='#F11L120' id='F11L120'> 120</a>
</div>			</aside>
			<code style='margin-left: 4em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Macro</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">Latte</span><span class="hk">\</span><span class="hd">Compiler</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Latte</span><span class="hk">\</span><span class="hd">MacroNode</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Latte</span><span class="hk">\</span><span class="hd">Macros</span><span class="hk">\</span><span class="hd">MacroSet</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Latte</span><span class="hk">\</span><span class="hd">PhpWriter</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Latte&nbsp;template&nbsp;engine&nbsp;image&nbsp;macros<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">ImageMacro&nbsp;</span><span class="hk">extends&nbsp;</span><span class="hd">MacroSet<br /></span><span class="hk">{<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Installs&nbsp;the&nbsp;macro&nbsp;set&nbsp;into&nbsp;the&nbsp;template&nbsp;compiler.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Compiler&nbsp;$compiler<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;void|static<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;static&nbsp;function&nbsp;</span><span class="hd">install</span><span class="hk">(</span><span class="hd">Compiler&nbsp;$compiler</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$macroSet&nbsp;</span><span class="hk">=&nbsp;new&nbsp;static(</span><span class="hd">$compiler</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$macroSet</span><span class="hk">-&gt;</span><span class="hd">setup</span><span class="hk">();<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;template&nbsp;macros&nbsp;up.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">setup</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">addMacro</span><span class="hk">(</span><span class="hs">'src'</span><span class="hk">,&nbsp;</span><span class="hd">NULL</span><span class="hk">,&nbsp;</span><span class="hd">NULL</span><span class="hk">,&nbsp;[</span><span class="hd">$this</span><span class="hk">,&nbsp;</span><span class="hs">'macroSrc'</span><span class="hk">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">addMacro</span><span class="hk">(</span><span class="hs">'bg'</span><span class="hk">,&nbsp;</span><span class="hd">NULL</span><span class="hk">,&nbsp;</span><span class="hd">NULL</span><span class="hk">,&nbsp;[</span><span class="hd">$this</span><span class="hk">,&nbsp;</span><span class="hs">'macroBg'</span><span class="hk">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">addMacro</span><span class="hk">(</span><span class="hs">'image'</span><span class="hk">,&nbsp;[</span><span class="hd">$this</span><span class="hk">,&nbsp;</span><span class="hs">'macroImageBegin'</span><span class="hk">],&nbsp;</span><span class="hd">NULL</span><span class="hk">,&nbsp;[</span><span class="hd">$this</span><span class="hk">,&nbsp;</span><span class="hs">'macroImage'</span><span class="hk">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">addMacro</span><span class="hk">(</span><span class="hs">'crop'</span><span class="hk">,&nbsp;[</span><span class="hd">$this</span><span class="hk">,&nbsp;</span><span class="hs">'macroCropBegin'</span><span class="hk">],&nbsp;</span><span class="hd">NULL</span><span class="hk">,&nbsp;[</span><span class="hd">$this</span><span class="hk">,&nbsp;</span><span class="hs">'macroCrop'</span><span class="hk">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;`n:src="$image"`&nbsp;macro.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;MacroNode&nbsp;$node<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;PhpWriter&nbsp;$writer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">macroBg</span><span class="hk">(</span><span class="hd">MacroNode&nbsp;$node</span><span class="hk">,&nbsp;</span><span class="hd">PhpWriter&nbsp;$writer</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$writer</span><span class="hk">-&gt;</span><span class="hd">write</span><span class="hk">(</span><span class="hs">'&nbsp;?&gt;&nbsp;style="background-image:&nbsp;url(\'&lt;?php&nbsp;$imageRequest&nbsp;=&nbsp;Rostenkowski\ImageStore\Requests\ImageRequest::crop(%node.word,&nbsp;%node.array?);&nbsp;echo&nbsp;%escape($__imagestore-&gt;link($imageRequest));&nbsp;?&gt;\');"&lt;?php&nbsp;'</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;`n:crop="$image"`&nbsp;macro.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;MacroNode&nbsp;$node<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;PhpWriter&nbsp;$writer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">macroCrop</span><span class="hk">(</span><span class="hd">MacroNode&nbsp;$node</span><span class="hk">,&nbsp;</span><span class="hd">PhpWriter&nbsp;$writer</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$writer</span><span class="hk">-&gt;</span><span class="hd">write</span><span class="hk">(</span><span class="hs">'&nbsp;?&gt;&nbsp;src="&lt;?php&nbsp;$imageRequest&nbsp;=&nbsp;Rostenkowski\ImageStore\Requests\ImageRequest::crop(%node.word,&nbsp;%node.array?);&nbsp;echo&nbsp;%escape($__imagestore-&gt;link($imageRequest));&nbsp;?&gt;"&lt;?php&nbsp;'</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;`{crop&nbsp;$image&nbsp;...}`&nbsp;macro.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;MacroNode&nbsp;$node<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;PhpWriter&nbsp;$writer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">macroCropBegin</span><span class="hk">(</span><span class="hd">MacroNode&nbsp;$node</span><span class="hk">,&nbsp;</span><span class="hd">PhpWriter&nbsp;$writer</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$writer</span><span class="hk">-&gt;</span><span class="hd">write</span><span class="hk">(</span><span class="hs">'$imageRequest&nbsp;=&nbsp;Rostenkowski\ImageStore\Requests\ImageRequest::crop(%node.word,&nbsp;%node.array?);&nbsp;echo&nbsp;%escape($__imagestore-&gt;link($imageRequest));'</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;`n:image="$image"`&nbsp;macro.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;MacroNode&nbsp;$node<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;PhpWriter&nbsp;$writer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">macroImage</span><span class="hk">(</span><span class="hd">MacroNode&nbsp;$node</span><span class="hk">,&nbsp;</span><span class="hd">PhpWriter&nbsp;$writer</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$writer</span><span class="hk">-&gt;</span><span class="hd">write</span><span class="hk">(</span><span class="hs">'&nbsp;?&gt;&nbsp;href="&lt;?php&nbsp;$imageRequest&nbsp;=&nbsp;Rostenkowski\ImageStore\Requests\ImageRequest::fromMacro(%node.word,&nbsp;%node.array?);&nbsp;echo&nbsp;%escape($__imagestore-&gt;link($imageRequest));&nbsp;?&gt;"&lt;?php&nbsp;'</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;`{image&nbsp;$image&nbsp;...}`&nbsp;macro.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;MacroNode&nbsp;$node<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;PhpWriter&nbsp;$writer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">macroImageBegin</span><span class="hk">(</span><span class="hd">MacroNode&nbsp;$node</span><span class="hk">,&nbsp;</span><span class="hd">PhpWriter&nbsp;$writer</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$writer</span><span class="hk">-&gt;</span><span class="hd">write</span><span class="hk">(</span><span class="hs">'$imageRequest&nbsp;=&nbsp;Rostenkowski\ImageStore\Requests\ImageRequest::fromMacro(%node.word,&nbsp;%node.array?);&nbsp;echo&nbsp;%escape($__imagestore-&gt;link($imageRequest));'</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;`n:src="$image"`&nbsp;macro.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;MacroNode&nbsp;$node<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;PhpWriter&nbsp;$writer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">macroSrc</span><span class="hk">(</span><span class="hd">MacroNode&nbsp;$node</span><span class="hk">,&nbsp;</span><span class="hd">PhpWriter&nbsp;$writer</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$writer</span><span class="hk">-&gt;</span><span class="hd">write</span><span class="hk">(</span><span class="hs">'$imageRequest&nbsp;=&nbsp;Rostenkowski\ImageStore\Requests\ImageRequest::fromMacro(%node.word,&nbsp;%node.array?);&nbsp;?&gt;&nbsp;src="&lt;?php&nbsp;echo&nbsp;%escape($__imagestore-&gt;link($imageRequest));&nbsp;?&gt;"&lt;?php&nbsp;'</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F12" class="toggle">ImageStore/Request.php</a></td>
		</tr>
		</table>

		<div class="code" id="F12">
		<div>
			<aside>
			<div><a href='#F12L1' id='F12L1'>  1</a>
<a href='#F12L2' id='F12L2'>  2</a>
<a href='#F12L3' id='F12L3'>  3</a>
<a href='#F12L4' id='F12L4'>  4</a>
<a href='#F12L5' id='F12L5'>  5</a>
<a href='#F12L6' id='F12L6'>  6</a>
<a href='#F12L7' id='F12L7'>  7</a>
<a href='#F12L8' id='F12L8'>  8</a></div><div class='t'><a href='#F12L9' id='F12L9'>  9</a></div><div><a href='#F12L10' id='F12L10'> 10</a>
<a href='#F12L11' id='F12L11'> 11</a>
<a href='#F12L12' id='F12L12'> 12</a>
<a href='#F12L13' id='F12L13'> 13</a>
<a href='#F12L14' id='F12L14'> 14</a>
<a href='#F12L15' id='F12L15'> 15</a>
<a href='#F12L16' id='F12L16'> 16</a>
<a href='#F12L17' id='F12L17'> 17</a>
<a href='#F12L18' id='F12L18'> 18</a>
<a href='#F12L19' id='F12L19'> 19</a>
<a href='#F12L20' id='F12L20'> 20</a>
<a href='#F12L21' id='F12L21'> 21</a>
<a href='#F12L22' id='F12L22'> 22</a>
<a href='#F12L23' id='F12L23'> 23</a>
<a href='#F12L24' id='F12L24'> 24</a>
<a href='#F12L25' id='F12L25'> 25</a>
<a href='#F12L26' id='F12L26'> 26</a>
<a href='#F12L27' id='F12L27'> 27</a>
<a href='#F12L28' id='F12L28'> 28</a>
<a href='#F12L29' id='F12L29'> 29</a>
<a href='#F12L30' id='F12L30'> 30</a>
<a href='#F12L31' id='F12L31'> 31</a>
<a href='#F12L32' id='F12L32'> 32</a>
<a href='#F12L33' id='F12L33'> 33</a>
<a href='#F12L34' id='F12L34'> 34</a>
<a href='#F12L35' id='F12L35'> 35</a>
<a href='#F12L36' id='F12L36'> 36</a>
<a href='#F12L37' id='F12L37'> 37</a>
<a href='#F12L38' id='F12L38'> 38</a>
<a href='#F12L39' id='F12L39'> 39</a>
<a href='#F12L40' id='F12L40'> 40</a>
<a href='#F12L41' id='F12L41'> 41</a>
<a href='#F12L42' id='F12L42'> 42</a>
<a href='#F12L43' id='F12L43'> 43</a>
<a href='#F12L44' id='F12L44'> 44</a>
<a href='#F12L45' id='F12L45'> 45</a>
<a href='#F12L46' id='F12L46'> 46</a>
<a href='#F12L47' id='F12L47'> 47</a>
<a href='#F12L48' id='F12L48'> 48</a>
<a href='#F12L49' id='F12L49'> 49</a>
<a href='#F12L50' id='F12L50'> 50</a>
<a href='#F12L51' id='F12L51'> 51</a>
<a href='#F12L52' id='F12L52'> 52</a>
<a href='#F12L53' id='F12L53'> 53</a>
<a href='#F12L54' id='F12L54'> 54</a>
<a href='#F12L55' id='F12L55'> 55</a>
<a href='#F12L56' id='F12L56'> 56</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">;<br /><br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Image&nbsp;request&nbsp;interface<br />&nbsp;*/<br /></span><span class="hk">interface&nbsp;</span><span class="hd">Request<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;</span><span class="hd">ORIGINAL&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">0</span><span class="hk">;<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;requested&nbsp;image&nbsp;thumbnail&nbsp;cropping&nbsp;flag.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getCrop</span><span class="hk">();<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;requested&nbsp;image&nbsp;thumbnail&nbsp;dimensions.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getDimensions</span><span class="hk">();<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;requested&nbsp;image&nbsp;thumbnail&nbsp;flags.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getFlags</span><span class="hk">();<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;requested&nbsp;image&nbsp;meta&nbsp;information.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getMeta</span><span class="hk">();<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;requested&nbsp;image&nbsp;meta&nbsp;information.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;$meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">setMeta</span><span class="hk">(</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">);<br /><br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F13" class="toggle">ImageStore/Entity/ImageEntity.php</a></td>
		</tr>
		</table>

		<div class="code" id="F13">
		<div>
			<aside>
			<div><a href='#F13L1' id='F13L1'>   1</a>
<a href='#F13L2' id='F13L2'>   2</a>
<a href='#F13L3' id='F13L3'>   3</a>
<a href='#F13L4' id='F13L4'>   4</a>
<a href='#F13L5' id='F13L5'>   5</a>
<a href='#F13L6' id='F13L6'>   6</a>
<a href='#F13L7' id='F13L7'>   7</a>
<a href='#F13L8' id='F13L8'>   8</a>
<a href='#F13L9' id='F13L9'>   9</a>
<a href='#F13L10' id='F13L10'>  10</a>
<a href='#F13L11' id='F13L11'>  11</a>
<a href='#F13L12' id='F13L12'>  12</a>
<a href='#F13L13' id='F13L13'>  13</a>
<a href='#F13L14' id='F13L14'>  14</a>
<a href='#F13L15' id='F13L15'>  15</a>
<a href='#F13L16' id='F13L16'>  16</a></div><div class='t'><a href='#F13L17' id='F13L17'>  17</a></div><div><a href='#F13L18' id='F13L18'>  18</a>
<a href='#F13L19' id='F13L19'>  19</a>
<a href='#F13L20' id='F13L20'>  20</a>
<a href='#F13L21' id='F13L21'>  21</a>
<a href='#F13L22' id='F13L22'>  22</a>
<a href='#F13L23' id='F13L23'>  23</a>
<a href='#F13L24' id='F13L24'>  24</a>
<a href='#F13L25' id='F13L25'>  25</a>
<a href='#F13L26' id='F13L26'>  26</a>
<a href='#F13L27' id='F13L27'>  27</a>
<a href='#F13L28' id='F13L28'>  28</a>
<a href='#F13L29' id='F13L29'>  29</a>
<a href='#F13L30' id='F13L30'>  30</a>
<a href='#F13L31' id='F13L31'>  31</a>
<a href='#F13L32' id='F13L32'>  32</a>
<a href='#F13L33' id='F13L33'>  33</a>
<a href='#F13L34' id='F13L34'>  34</a>
<a href='#F13L35' id='F13L35'>  35</a>
<a href='#F13L36' id='F13L36'>  36</a>
<a href='#F13L37' id='F13L37'>  37</a>
<a href='#F13L38' id='F13L38'>  38</a>
<a href='#F13L39' id='F13L39'>  39</a>
<a href='#F13L40' id='F13L40'>  40</a>
<a href='#F13L41' id='F13L41'>  41</a>
<a href='#F13L42' id='F13L42'>  42</a>
<a href='#F13L43' id='F13L43'>  43</a>
<a href='#F13L44' id='F13L44'>  44</a>
<a href='#F13L45' id='F13L45'>  45</a>
<a href='#F13L46' id='F13L46'>  46</a>
<a href='#F13L47' id='F13L47'>  47</a>
<a href='#F13L48' id='F13L48'>  48</a>
<a href='#F13L49' id='F13L49'>  49</a>
<a href='#F13L50' id='F13L50'>  50</a>
<a href='#F13L51' id='F13L51'>  51</a>
<a href='#F13L52' id='F13L52'>  52</a>
<a href='#F13L53' id='F13L53'>  53</a>
<a href='#F13L54' id='F13L54'>  54</a>
<a href='#F13L55' id='F13L55'>  55</a></div><div class='t'><a href='#F13L56' id='F13L56'>  56</a></div><div class='dead'><a href='#F13L57' id='F13L57'>  57</a></div><div><a href='#F13L58' id='F13L58'>  58</a>
<a href='#F13L59' id='F13L59'>  59</a>
<a href='#F13L60' id='F13L60'>  60</a>
<a href='#F13L61' id='F13L61'>  61</a>
<a href='#F13L62' id='F13L62'>  62</a>
<a href='#F13L63' id='F13L63'>  63</a>
<a href='#F13L64' id='F13L64'>  64</a>
<a href='#F13L65' id='F13L65'>  65</a></div><div class='t'><a href='#F13L66' id='F13L66'>  66</a></div><div><a href='#F13L67' id='F13L67'>  67</a></div><div class='t'><a href='#F13L68' id='F13L68'>  68</a></div><div class='dead'><a href='#F13L69' id='F13L69'>  69</a></div><div><a href='#F13L70' id='F13L70'>  70</a>
<a href='#F13L71' id='F13L71'>  71</a>
<a href='#F13L72' id='F13L72'>  72</a>
<a href='#F13L73' id='F13L73'>  73</a>
<a href='#F13L74' id='F13L74'>  74</a>
<a href='#F13L75' id='F13L75'>  75</a>
<a href='#F13L76' id='F13L76'>  76</a></div><div class='t'><a href='#F13L77' id='F13L77'>  77</a></div><div class='dead'><a href='#F13L78' id='F13L78'>  78</a></div><div><a href='#F13L79' id='F13L79'>  79</a>
<a href='#F13L80' id='F13L80'>  80</a>
<a href='#F13L81' id='F13L81'>  81</a>
<a href='#F13L82' id='F13L82'>  82</a>
<a href='#F13L83' id='F13L83'>  83</a>
<a href='#F13L84' id='F13L84'>  84</a>
<a href='#F13L85' id='F13L85'>  85</a>
<a href='#F13L86' id='F13L86'>  86</a>
<a href='#F13L87' id='F13L87'>  87</a>
<a href='#F13L88' id='F13L88'>  88</a>
<a href='#F13L89' id='F13L89'>  89</a></div><div class='t'><a href='#F13L90' id='F13L90'>  90</a>
<a href='#F13L91' id='F13L91'>  91</a></div><div class='dead'><a href='#F13L92' id='F13L92'>  92</a></div><div class='t'><a href='#F13L93' id='F13L93'>  93</a>
<a href='#F13L94' id='F13L94'>  94</a>
<a href='#F13L95' id='F13L95'>  95</a></div><div class='dead'><a href='#F13L96' id='F13L96'>  96</a></div><div><a href='#F13L97' id='F13L97'>  97</a></div><div class='t'><a href='#F13L98' id='F13L98'>  98</a></div><div class='dead'><a href='#F13L99' id='F13L99'>  99</a></div><div><a href='#F13L100' id='F13L100'> 100</a>
<a href='#F13L101' id='F13L101'> 101</a>
<a href='#F13L102' id='F13L102'> 102</a>
<a href='#F13L103' id='F13L103'> 103</a>
<a href='#F13L104' id='F13L104'> 104</a>
<a href='#F13L105' id='F13L105'> 105</a>
<a href='#F13L106' id='F13L106'> 106</a>
<a href='#F13L107' id='F13L107'> 107</a></div><div class='t'><a href='#F13L108' id='F13L108'> 108</a></div><div><a href='#F13L109' id='F13L109'> 109</a></div><div class='t'><a href='#F13L110' id='F13L110'> 110</a></div><div class='dead'><a href='#F13L111' id='F13L111'> 111</a></div><div><a href='#F13L112' id='F13L112'> 112</a>
<a href='#F13L113' id='F13L113'> 113</a>
<a href='#F13L114' id='F13L114'> 114</a>
<a href='#F13L115' id='F13L115'> 115</a>
<a href='#F13L116' id='F13L116'> 116</a>
<a href='#F13L117' id='F13L117'> 117</a>
<a href='#F13L118' id='F13L118'> 118</a>
<a href='#F13L119' id='F13L119'> 119</a>
<a href='#F13L120' id='F13L120'> 120</a>
<a href='#F13L121' id='F13L121'> 121</a>
<a href='#F13L122' id='F13L122'> 122</a></div><div class='t'><a href='#F13L123' id='F13L123'> 123</a>
<a href='#F13L124' id='F13L124'> 124</a></div><div class='dead'><a href='#F13L125' id='F13L125'> 125</a></div><div><a href='#F13L126' id='F13L126'> 126</a></div><div class='t'><a href='#F13L127' id='F13L127'> 127</a></div><div class='dead'><a href='#F13L128' id='F13L128'> 128</a></div><div><a href='#F13L129' id='F13L129'> 129</a>
<a href='#F13L130' id='F13L130'> 130</a>
<a href='#F13L131' id='F13L131'> 131</a>
<a href='#F13L132' id='F13L132'> 132</a>
<a href='#F13L133' id='F13L133'> 133</a>
<a href='#F13L134' id='F13L134'> 134</a>
<a href='#F13L135' id='F13L135'> 135</a></div><div class='t'><a href='#F13L136' id='F13L136'> 136</a></div><div class='dead'><a href='#F13L137' id='F13L137'> 137</a></div><div><a href='#F13L138' id='F13L138'> 138</a>
<a href='#F13L139' id='F13L139'> 139</a>
<a href='#F13L140' id='F13L140'> 140</a>
<a href='#F13L141' id='F13L141'> 141</a>
<a href='#F13L142' id='F13L142'> 142</a>
<a href='#F13L143' id='F13L143'> 143</a>
<a href='#F13L144' id='F13L144'> 144</a></div><div class='t'><a href='#F13L145' id='F13L145'> 145</a>
<a href='#F13L146' id='F13L146'> 146</a></div><div><a href='#F13L147' id='F13L147'> 147</a>
<a href='#F13L148' id='F13L148'> 148</a>
<a href='#F13L149' id='F13L149'> 149</a>
<a href='#F13L150' id='F13L150'> 150</a>
<a href='#F13L151' id='F13L151'> 151</a>
<a href='#F13L152' id='F13L152'> 152</a>
<a href='#F13L153' id='F13L153'> 153</a></div><div class='t'><a href='#F13L154' id='F13L154'> 154</a></div><div class='dead'><a href='#F13L155' id='F13L155'> 155</a></div><div><a href='#F13L156' id='F13L156'> 156</a>
<a href='#F13L157' id='F13L157'> 157</a>
<a href='#F13L158' id='F13L158'> 158</a>
<a href='#F13L159' id='F13L159'> 159</a>
<a href='#F13L160' id='F13L160'> 160</a>
<a href='#F13L161' id='F13L161'> 161</a>
<a href='#F13L162' id='F13L162'> 162</a></div><div class='t'><a href='#F13L163' id='F13L163'> 163</a>
<a href='#F13L164' id='F13L164'> 164</a></div><div><a href='#F13L165' id='F13L165'> 165</a>
</div>			</aside>
			<code style='margin-left: 4em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Entity</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Utils</span><span class="hk">\</span><span class="hd">Image</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Utils</span><span class="hk">\</span><span class="hd">Strings</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">\</span><span class="hd">HashException</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Exceptions</span><span class="hk">\</span><span class="hd">ImageTypeException</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Meta</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Basic&nbsp;implementation&nbsp;of&nbsp;the&nbsp;image&nbsp;meta&nbsp;information&nbsp;as&nbsp;Doctrine&nbsp;entity.<br />&nbsp;*<br />&nbsp;*&nbsp;@ORM\MappedSuperClass<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">ImageEntity&nbsp;</span><span class="hk">implements&nbsp;</span><span class="hd">Meta<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;SHA1&nbsp;hash&nbsp;of&nbsp;the&nbsp;original&nbsp;image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(length=40,&nbsp;nullable=true)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$hash</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Original&nbsp;image&nbsp;type&nbsp;as&nbsp;defined&nbsp;in&nbsp;the&nbsp;`Image`&nbsp;class&nbsp;constants&nbsp;`JPEG`,&nbsp;`GIF`&nbsp;and&nbsp;`PNG`.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(type="integer",&nbsp;nullable=true)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$type</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(type="integer",&nbsp;nullable=true)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$width</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(type="integer",&nbsp;nullable=true)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$height</span><span class="hk">;<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getHash</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">hash</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;string&nbsp;$hash<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageEntity<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">setHash</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">hash&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">checkHash</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getType</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">type</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Checks&nbsp;that&nbsp;the&nbsp;given&nbsp;string&nbsp;is&nbsp;valid&nbsp;SHA1&nbsp;hash&nbsp;and&nbsp;normalizes&nbsp;it&nbsp;to&nbsp;lower&nbsp;case.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;string&nbsp;$hash&nbsp;Image&nbsp;hash&nbsp;to&nbsp;validate<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;HashException&nbsp;If&nbsp;the&nbsp;hash&nbsp;is&nbsp;not&nbsp;valid&nbsp;image&nbsp;hash<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;valid&nbsp;image&nbsp;hash<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">checkHash</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span class="hd">is_string</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span class="hd">HashException</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$hash&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">Strings</span><span class="hk">::</span><span class="hd">lower</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span class="hd">preg_match</span><span class="hk">(</span><span class="hs">'/^[0-9a-f]{40}$/'</span><span class="hk">,&nbsp;</span><span class="hd">$hash</span><span class="hk">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span class="hd">HashException</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$hash</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;integer&nbsp;$type<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageEntity<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">setType</span><span class="hk">(</span><span class="hd">$type</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">type&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">checkType</span><span class="hk">(</span><span class="hd">$type</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Checks&nbsp;the&nbsp;given&nbsp;image&nbsp;type&nbsp;to&nbsp;be&nbsp;one&nbsp;of&nbsp;the&nbsp;supported&nbsp;types.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;integer&nbsp;$type<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ImageTypeException<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;function&nbsp;</span><span class="hd">checkType</span><span class="hk">(</span><span class="hd">$type</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span class="hd">in_array</span><span class="hk">(</span><span class="hd">$type</span><span class="hk">,&nbsp;array(</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">JPEG</span><span class="hk">,&nbsp;</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">PNG</span><span class="hk">,&nbsp;</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">GIF</span><span class="hk">),&nbsp;</span><span class="hd">TRUE</span><span class="hk">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span class="hd">ImageTypeException</span><span class="hk">(</span><span class="hd">$type</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$type</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getHeight</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">height</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$height<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">setHeight</span><span class="hk">(</span><span class="hd">$height</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">height&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$height</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getWidth</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">width</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$width<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">setWidth</span><span class="hk">(</span><span class="hd">$width</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">width&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$width</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F14" class="toggle">ImageStore/Entity/EmptyImage.php</a></td>
		</tr>
		</table>

		<div class="code" id="F14">
		<div>
			<aside>
			<div><a href='#F14L1' id='F14L1'>  1</a>
<a href='#F14L2' id='F14L2'>  2</a>
<a href='#F14L3' id='F14L3'>  3</a>
<a href='#F14L4' id='F14L4'>  4</a>
<a href='#F14L5' id='F14L5'>  5</a>
<a href='#F14L6' id='F14L6'>  6</a>
<a href='#F14L7' id='F14L7'>  7</a>
<a href='#F14L8' id='F14L8'>  8</a>
<a href='#F14L9' id='F14L9'>  9</a>
<a href='#F14L10' id='F14L10'> 10</a>
<a href='#F14L11' id='F14L11'> 11</a></div><div class='t'><a href='#F14L12' id='F14L12'> 12</a></div><div><a href='#F14L13' id='F14L13'> 13</a>
<a href='#F14L14' id='F14L14'> 14</a>
<a href='#F14L15' id='F14L15'> 15</a>
<a href='#F14L16' id='F14L16'> 16</a></div><div class='t'><a href='#F14L17' id='F14L17'> 17</a></div><div class='dead'><a href='#F14L18' id='F14L18'> 18</a></div><div><a href='#F14L19' id='F14L19'> 19</a>
<a href='#F14L20' id='F14L20'> 20</a>
<a href='#F14L21' id='F14L21'> 21</a>
<a href='#F14L22' id='F14L22'> 22</a></div><div class='t'><a href='#F14L23' id='F14L23'> 23</a></div><div class='dead'><a href='#F14L24' id='F14L24'> 24</a></div><div><a href='#F14L25' id='F14L25'> 25</a>
<a href='#F14L26' id='F14L26'> 26</a>
<a href='#F14L27' id='F14L27'> 27</a>
<a href='#F14L28' id='F14L28'> 28</a></div><div class='t'><a href='#F14L29' id='F14L29'> 29</a></div><div class='dead'><a href='#F14L30' id='F14L30'> 30</a></div><div><a href='#F14L31' id='F14L31'> 31</a>
<a href='#F14L32' id='F14L32'> 32</a>
<a href='#F14L33' id='F14L33'> 33</a>
<a href='#F14L34' id='F14L34'> 34</a></div><div class='t'><a href='#F14L35' id='F14L35'> 35</a></div><div class='dead'><a href='#F14L36' id='F14L36'> 36</a></div><div><a href='#F14L37' id='F14L37'> 37</a>
<a href='#F14L38' id='F14L38'> 38</a>
<a href='#F14L39' id='F14L39'> 39</a>
<a href='#F14L40' id='F14L40'> 40</a></div><div class='t'><a href='#F14L41' id='F14L41'> 41</a></div><div class='dead'><a href='#F14L42' id='F14L42'> 42</a></div><div><a href='#F14L43' id='F14L43'> 43</a>
<a href='#F14L44' id='F14L44'> 44</a>
<a href='#F14L45' id='F14L45'> 45</a>
<a href='#F14L46' id='F14L46'> 46</a></div><div class='t'><a href='#F14L47' id='F14L47'> 47</a></div><div class='dead'><a href='#F14L48' id='F14L48'> 48</a></div><div><a href='#F14L49' id='F14L49'> 49</a>
<a href='#F14L50' id='F14L50'> 50</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Entity</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Utils</span><span class="hk">\</span><span class="hd">Image</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Meta</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;"Image&nbsp;not&nbsp;found"&nbsp;entity<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">EmptyImage&nbsp;</span><span class="hk">implements&nbsp;</span><span class="hd">Meta<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span class="hd">getHash</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hs">'_empty'</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span class="hd">getType</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">PNG</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span class="hd">setHash</span><span class="hk">(</span><span class="hd">$hash</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\</span><span class="hd">LogicException</span><span class="hk">(</span><span class="hs">'Unavailable&nbsp;image&nbsp;hash&nbsp;cannot&nbsp;be&nbsp;changed.'</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span class="hd">setType</span><span class="hk">(</span><span class="hd">$type</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\</span><span class="hd">LogicException</span><span class="hk">(</span><span class="hs">'Unavailable&nbsp;image&nbsp;hash&nbsp;cannot&nbsp;be&nbsp;changed.'</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span class="hd">getHeight</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">1080</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span class="hd">getWidth</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">1920</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F15" class="toggle">ImageStore/Storage.php</a></td>
		</tr>
		</table>

		<div class="code" id="F15">
		<div>
			<aside>
			<div><a href='#F15L1' id='F15L1'>  1</a>
<a href='#F15L2' id='F15L2'>  2</a>
<a href='#F15L3' id='F15L3'>  3</a>
<a href='#F15L4' id='F15L4'>  4</a>
<a href='#F15L5' id='F15L5'>  5</a>
<a href='#F15L6' id='F15L6'>  6</a>
<a href='#F15L7' id='F15L7'>  7</a>
<a href='#F15L8' id='F15L8'>  8</a>
<a href='#F15L9' id='F15L9'>  9</a>
<a href='#F15L10' id='F15L10'> 10</a></div><div class='t'><a href='#F15L11' id='F15L11'> 11</a></div><div><a href='#F15L12' id='F15L12'> 12</a>
<a href='#F15L13' id='F15L13'> 13</a>
<a href='#F15L14' id='F15L14'> 14</a>
<a href='#F15L15' id='F15L15'> 15</a>
<a href='#F15L16' id='F15L16'> 16</a>
<a href='#F15L17' id='F15L17'> 17</a>
<a href='#F15L18' id='F15L18'> 18</a>
<a href='#F15L19' id='F15L19'> 19</a>
<a href='#F15L20' id='F15L20'> 20</a>
<a href='#F15L21' id='F15L21'> 21</a>
<a href='#F15L22' id='F15L22'> 22</a>
<a href='#F15L23' id='F15L23'> 23</a>
<a href='#F15L24' id='F15L24'> 24</a>
<a href='#F15L25' id='F15L25'> 25</a>
<a href='#F15L26' id='F15L26'> 26</a>
<a href='#F15L27' id='F15L27'> 27</a>
<a href='#F15L28' id='F15L28'> 28</a>
<a href='#F15L29' id='F15L29'> 29</a>
<a href='#F15L30' id='F15L30'> 30</a>
<a href='#F15L31' id='F15L31'> 31</a>
<a href='#F15L32' id='F15L32'> 32</a>
<a href='#F15L33' id='F15L33'> 33</a>
<a href='#F15L34' id='F15L34'> 34</a>
<a href='#F15L35' id='F15L35'> 35</a>
<a href='#F15L36' id='F15L36'> 36</a>
<a href='#F15L37' id='F15L37'> 37</a>
<a href='#F15L38' id='F15L38'> 38</a>
<a href='#F15L39' id='F15L39'> 39</a>
<a href='#F15L40' id='F15L40'> 40</a>
<a href='#F15L41' id='F15L41'> 41</a>
<a href='#F15L42' id='F15L42'> 42</a>
<a href='#F15L43' id='F15L43'> 43</a>
<a href='#F15L44' id='F15L44'> 44</a>
<a href='#F15L45' id='F15L45'> 45</a>
<a href='#F15L46' id='F15L46'> 46</a>
<a href='#F15L47' id='F15L47'> 47</a>
<a href='#F15L48' id='F15L48'> 48</a>
<a href='#F15L49' id='F15L49'> 49</a>
<a href='#F15L50' id='F15L50'> 50</a>
<a href='#F15L51' id='F15L51'> 51</a>
<a href='#F15L52' id='F15L52'> 52</a>
<a href='#F15L53' id='F15L53'> 53</a>
<a href='#F15L54' id='F15L54'> 54</a>
<a href='#F15L55' id='F15L55'> 55</a>
<a href='#F15L56' id='F15L56'> 56</a>
<a href='#F15L57' id='F15L57'> 57</a>
<a href='#F15L58' id='F15L58'> 58</a>
<a href='#F15L59' id='F15L59'> 59</a>
<a href='#F15L60' id='F15L60'> 60</a>
<a href='#F15L61' id='F15L61'> 61</a>
<a href='#F15L62' id='F15L62'> 62</a>
<a href='#F15L63' id='F15L63'> 63</a>
<a href='#F15L64' id='F15L64'> 64</a>
<a href='#F15L65' id='F15L65'> 65</a>
<a href='#F15L66' id='F15L66'> 66</a>
<a href='#F15L67' id='F15L67'> 67</a>
<a href='#F15L68' id='F15L68'> 68</a>
<a href='#F15L69' id='F15L69'> 69</a>
<a href='#F15L70' id='F15L70'> 70</a>
<a href='#F15L71' id='F15L71'> 71</a>
<a href='#F15L72' id='F15L72'> 72</a>
<a href='#F15L73' id='F15L73'> 73</a>
<a href='#F15L74' id='F15L74'> 74</a>
<a href='#F15L75' id='F15L75'> 75</a>
<a href='#F15L76' id='F15L76'> 76</a>
<a href='#F15L77' id='F15L77'> 77</a>
<a href='#F15L78' id='F15L78'> 78</a>
<a href='#F15L79' id='F15L79'> 79</a>
<a href='#F15L80' id='F15L80'> 80</a>
<a href='#F15L81' id='F15L81'> 81</a>
<a href='#F15L82' id='F15L82'> 82</a>
<a href='#F15L83' id='F15L83'> 83</a>
<a href='#F15L84' id='F15L84'> 84</a>
<a href='#F15L85' id='F15L85'> 85</a>
<a href='#F15L86' id='F15L86'> 86</a>
<a href='#F15L87' id='F15L87'> 87</a>
<a href='#F15L88' id='F15L88'> 88</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Http</span><span class="hk">\</span><span class="hd">FileUpload</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Image&nbsp;Storage&nbsp;Interface<br />&nbsp;*/<br /></span><span class="hk">interface&nbsp;</span><span class="hd">Storage<br /></span><span class="hk">{<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;TRUE&nbsp;if&nbsp;the&nbsp;storage&nbsp;contains&nbsp;the&nbsp;given&nbsp;image.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;$meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;boolean<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">contains</span><span class="hk">(</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">);<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;requested&nbsp;image&nbsp;encapsulated&nbsp;in&nbsp;a&nbsp;HTTP&nbsp;response&nbsp;object.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;IResponse<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">download</span><span class="hk">(</span><span class="hd">Request&nbsp;$request</span><span class="hk">);<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;requested&nbsp;image&nbsp;object.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;mixed<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">fetch</span><span class="hk">(</span><span class="hd">Request&nbsp;$request</span><span class="hk">);<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;URL&nbsp;of&nbsp;the&nbsp;requested&nbsp;image&nbsp;thumbnail.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">link</span><span class="hk">(</span><span class="hd">Request&nbsp;$request</span><span class="hk">);<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Fetches&nbsp;the&nbsp;original&nbsp;stored&nbsp;image.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;$meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">original</span><span class="hk">(</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">);<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Removes&nbsp;the&nbsp;requested&nbsp;image&nbsp;from&nbsp;the&nbsp;storage.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;$meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;void<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">remove</span><span class="hk">(</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">);<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;requested&nbsp;image&nbsp;to&nbsp;the&nbsp;standard&nbsp;output.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;void<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">send</span><span class="hk">(</span><span class="hd">Request&nbsp;$request</span><span class="hk">);<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Uploads&nbsp;an&nbsp;image&nbsp;to&nbsp;the&nbsp;storage&nbsp;and&nbsp;store&nbsp;it's&nbsp;meta&nbsp;information&nbsp;in&nbsp;the&nbsp;given&nbsp;image&nbsp;entity.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;FileUpload&nbsp;$file<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;void<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">upload</span><span class="hk">(</span><span class="hd">FileUpload&nbsp;$file</span><span class="hk">,&nbsp;</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">);<br /><br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F16" class="toggle">ImageStore/Requests/ImageRequest.php</a></td>
		</tr>
		</table>

		<div class="code" id="F16">
		<div>
			<aside>
			<div><a href='#F16L1' id='F16L1'>   1</a>
<a href='#F16L2' id='F16L2'>   2</a>
<a href='#F16L3' id='F16L3'>   3</a>
<a href='#F16L4' id='F16L4'>   4</a>
<a href='#F16L5' id='F16L5'>   5</a>
<a href='#F16L6' id='F16L6'>   6</a>
<a href='#F16L7' id='F16L7'>   7</a>
<a href='#F16L8' id='F16L8'>   8</a>
<a href='#F16L9' id='F16L9'>   9</a>
<a href='#F16L10' id='F16L10'>  10</a>
<a href='#F16L11' id='F16L11'>  11</a>
<a href='#F16L12' id='F16L12'>  12</a>
<a href='#F16L13' id='F16L13'>  13</a>
<a href='#F16L14' id='F16L14'>  14</a></div><div class='t'><a href='#F16L15' id='F16L15'>  15</a></div><div><a href='#F16L16' id='F16L16'>  16</a>
<a href='#F16L17' id='F16L17'>  17</a>
<a href='#F16L18' id='F16L18'>  18</a>
<a href='#F16L19' id='F16L19'>  19</a>
<a href='#F16L20' id='F16L20'>  20</a>
<a href='#F16L21' id='F16L21'>  21</a>
<a href='#F16L22' id='F16L22'>  22</a>
<a href='#F16L23' id='F16L23'>  23</a>
<a href='#F16L24' id='F16L24'>  24</a>
<a href='#F16L25' id='F16L25'>  25</a>
<a href='#F16L26' id='F16L26'>  26</a>
<a href='#F16L27' id='F16L27'>  27</a>
<a href='#F16L28' id='F16L28'>  28</a>
<a href='#F16L29' id='F16L29'>  29</a>
<a href='#F16L30' id='F16L30'>  30</a>
<a href='#F16L31' id='F16L31'>  31</a>
<a href='#F16L32' id='F16L32'>  32</a>
<a href='#F16L33' id='F16L33'>  33</a>
<a href='#F16L34' id='F16L34'>  34</a>
<a href='#F16L35' id='F16L35'>  35</a>
<a href='#F16L36' id='F16L36'>  36</a>
<a href='#F16L37' id='F16L37'>  37</a>
<a href='#F16L38' id='F16L38'>  38</a>
<a href='#F16L39' id='F16L39'>  39</a>
<a href='#F16L40' id='F16L40'>  40</a>
<a href='#F16L41' id='F16L41'>  41</a>
<a href='#F16L42' id='F16L42'>  42</a>
<a href='#F16L43' id='F16L43'>  43</a>
<a href='#F16L44' id='F16L44'>  44</a>
<a href='#F16L45' id='F16L45'>  45</a>
<a href='#F16L46' id='F16L46'>  46</a>
<a href='#F16L47' id='F16L47'>  47</a>
<a href='#F16L48' id='F16L48'>  48</a>
<a href='#F16L49' id='F16L49'>  49</a>
<a href='#F16L50' id='F16L50'>  50</a>
<a href='#F16L51' id='F16L51'>  51</a>
<a href='#F16L52' id='F16L52'>  52</a>
<a href='#F16L53' id='F16L53'>  53</a>
<a href='#F16L54' id='F16L54'>  54</a>
<a href='#F16L55' id='F16L55'>  55</a>
<a href='#F16L56' id='F16L56'>  56</a></div><div class='t'><a href='#F16L57' id='F16L57'>  57</a>
<a href='#F16L58' id='F16L58'>  58</a>
<a href='#F16L59' id='F16L59'>  59</a>
<a href='#F16L60' id='F16L60'>  60</a>
<a href='#F16L61' id='F16L61'>  61</a></div><div><a href='#F16L62' id='F16L62'>  62</a>
<a href='#F16L63' id='F16L63'>  63</a>
<a href='#F16L64' id='F16L64'>  64</a>
<a href='#F16L65' id='F16L65'>  65</a>
<a href='#F16L66' id='F16L66'>  66</a>
<a href='#F16L67' id='F16L67'>  67</a>
<a href='#F16L68' id='F16L68'>  68</a>
<a href='#F16L69' id='F16L69'>  69</a>
<a href='#F16L70' id='F16L70'>  70</a>
<a href='#F16L71' id='F16L71'>  71</a>
<a href='#F16L72' id='F16L72'>  72</a></div><div class='t'><a href='#F16L73' id='F16L73'>  73</a>
<a href='#F16L74' id='F16L74'>  74</a>
<a href='#F16L75' id='F16L75'>  75</a></div><div><a href='#F16L76' id='F16L76'>  76</a></div><div class='t'><a href='#F16L77' id='F16L77'>  77</a>
<a href='#F16L78' id='F16L78'>  78</a></div><div><a href='#F16L79' id='F16L79'>  79</a></div><div class='t'><a href='#F16L80' id='F16L80'>  80</a></div><div><a href='#F16L81' id='F16L81'>  81</a></div><div class='t'><a href='#F16L82' id='F16L82'>  82</a></div><div class='dead'><a href='#F16L83' id='F16L83'>  83</a></div><div><a href='#F16L84' id='F16L84'>  84</a>
<a href='#F16L85' id='F16L85'>  85</a>
<a href='#F16L86' id='F16L86'>  86</a>
<a href='#F16L87' id='F16L87'>  87</a>
<a href='#F16L88' id='F16L88'>  88</a>
<a href='#F16L89' id='F16L89'>  89</a>
<a href='#F16L90' id='F16L90'>  90</a>
<a href='#F16L91' id='F16L91'>  91</a>
<a href='#F16L92' id='F16L92'>  92</a>
<a href='#F16L93' id='F16L93'>  93</a>
<a href='#F16L94' id='F16L94'>  94</a></div><div class='t'><a href='#F16L95' id='F16L95'>  95</a>
<a href='#F16L96' id='F16L96'>  96</a>
<a href='#F16L97' id='F16L97'>  97</a></div><div><a href='#F16L98' id='F16L98'>  98</a></div><div class='t'><a href='#F16L99' id='F16L99'>  99</a></div><div class='dead'><a href='#F16L100' id='F16L100'> 100</a></div><div><a href='#F16L101' id='F16L101'> 101</a>
<a href='#F16L102' id='F16L102'> 102</a>
<a href='#F16L103' id='F16L103'> 103</a>
<a href='#F16L104' id='F16L104'> 104</a>
<a href='#F16L105' id='F16L105'> 105</a>
<a href='#F16L106' id='F16L106'> 106</a>
<a href='#F16L107' id='F16L107'> 107</a></div><div class='t'><a href='#F16L108' id='F16L108'> 108</a></div><div class='dead'><a href='#F16L109' id='F16L109'> 109</a></div><div><a href='#F16L110' id='F16L110'> 110</a>
<a href='#F16L111' id='F16L111'> 111</a>
<a href='#F16L112' id='F16L112'> 112</a>
<a href='#F16L113' id='F16L113'> 113</a>
<a href='#F16L114' id='F16L114'> 114</a>
<a href='#F16L115' id='F16L115'> 115</a>
<a href='#F16L116' id='F16L116'> 116</a></div><div class='t'><a href='#F16L117' id='F16L117'> 117</a></div><div class='dead'><a href='#F16L118' id='F16L118'> 118</a></div><div><a href='#F16L119' id='F16L119'> 119</a>
<a href='#F16L120' id='F16L120'> 120</a>
<a href='#F16L121' id='F16L121'> 121</a>
<a href='#F16L122' id='F16L122'> 122</a>
<a href='#F16L123' id='F16L123'> 123</a>
<a href='#F16L124' id='F16L124'> 124</a>
<a href='#F16L125' id='F16L125'> 125</a>
<a href='#F16L126' id='F16L126'> 126</a></div><div class='t'><a href='#F16L127' id='F16L127'> 127</a></div><div><a href='#F16L128' id='F16L128'> 128</a></div><div class='t'><a href='#F16L129' id='F16L129'> 129</a></div><div class='dead'><a href='#F16L130' id='F16L130'> 130</a></div><div><a href='#F16L131' id='F16L131'> 131</a>
<a href='#F16L132' id='F16L132'> 132</a>
<a href='#F16L133' id='F16L133'> 133</a>
<a href='#F16L134' id='F16L134'> 134</a>
<a href='#F16L135' id='F16L135'> 135</a>
<a href='#F16L136' id='F16L136'> 136</a>
<a href='#F16L137' id='F16L137'> 137</a></div><div class='t'><a href='#F16L138' id='F16L138'> 138</a></div><div class='dead'><a href='#F16L139' id='F16L139'> 139</a></div><div><a href='#F16L140' id='F16L140'> 140</a>
<a href='#F16L141' id='F16L141'> 141</a>
<a href='#F16L142' id='F16L142'> 142</a>
<a href='#F16L143' id='F16L143'> 143</a>
<a href='#F16L144' id='F16L144'> 144</a>
<a href='#F16L145' id='F16L145'> 145</a>
<a href='#F16L146' id='F16L146'> 146</a></div><div class='t'><a href='#F16L147' id='F16L147'> 147</a></div><div class='dead'><a href='#F16L148' id='F16L148'> 148</a></div><div><a href='#F16L149' id='F16L149'> 149</a>
<a href='#F16L150' id='F16L150'> 150</a>
</div>			</aside>
			<code style='margin-left: 4em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Requests</span><span class="hk">;<br /><br /><br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Object</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Nette</span><span class="hk">\</span><span class="hd">Utils</span><span class="hk">\</span><span class="hd">Image</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Entity</span><span class="hk">\</span><span class="hd">EmptyImage</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Meta</span><span class="hk">;<br />use&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">\</span><span class="hd">Request</span><span class="hk">;<br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Image&nbsp;request&nbsp;encapsulation<br />&nbsp;*/<br /></span><span class="hk">class&nbsp;</span><span class="hd">ImageRequest&nbsp;</span><span class="hk">extends&nbsp;</span><span class="hd">Object&nbsp;</span><span class="hk">implements&nbsp;</span><span class="hd">Request<br /></span><span class="hk">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;requested&nbsp;image&nbsp;meta&nbsp;information.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;Meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$meta</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;requested&nbsp;image&nbsp;thumbnail&nbsp;dimensions<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$dimensions</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;requested&nbsp;image&nbsp;thumbnail&nbsp;flags.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$flags</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;requested&nbsp;image&nbsp;thumbnail&nbsp;cropping&nbsp;flag.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;boolean<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">private&nbsp;</span><span class="hd">$crop&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">FALSE</span><span class="hk">;<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;the&nbsp;image&nbsp;request&nbsp;from&nbsp;the&nbsp;given&nbsp;meta&nbsp;information,&nbsp;requested&nbsp;dimensions&nbsp;and&nbsp;flags.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;&nbsp;&nbsp;&nbsp;$meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$dimensions<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$flags<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;boolean&nbsp;$crop<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">__construct</span><span class="hk">(</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">,&nbsp;</span><span class="hd">$dimensions&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">Request</span><span class="hk">::</span><span class="hd">ORIGINAL</span><span class="hk">,&nbsp;</span><span class="hd">$flags&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">Request</span><span class="hk">::</span><span class="hd">ORIGINAL</span><span class="hk">,&nbsp;</span><span class="hd">$crop&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">FALSE</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">meta&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$meta</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">dimensions&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$dimensions</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">flags&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$flags</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">crop&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$crop</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;image&nbsp;request&nbsp;from&nbsp;the&nbsp;crop&nbsp;macro&nbsp;arguments.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;&nbsp;$image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array&nbsp;$args<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageRequest<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;static&nbsp;function&nbsp;</span><span class="hd">crop</span><span class="hk">(</span><span class="hd">Meta&nbsp;$image&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">NULL</span><span class="hk">,&nbsp;</span><span class="hd">$args&nbsp;</span><span class="hk">=&nbsp;array())<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$image&nbsp;</span><span class="hk">===&nbsp;</span><span class="hd">NULL</span><span class="hk">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$image&nbsp;</span><span class="hk">=&nbsp;new&nbsp;</span><span class="hd">EmptyImage</span><span class="hk">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$dimensions&nbsp;</span><span class="hk">=&nbsp;isset(</span><span class="hd">$args</span><span class="hk">[</span><span class="hd">0</span><span class="hk">])&nbsp;?&nbsp;</span><span class="hd">$args</span><span class="hk">[</span><span class="hd">0</span><span class="hk">]&nbsp;:&nbsp;</span><span class="hd">Request</span><span class="hk">::</span><span class="hd">ORIGINAL</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$flags&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">Image</span><span class="hk">::</span><span class="hd">FIT</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$request&nbsp;</span><span class="hk">=&nbsp;new&nbsp;</span><span class="hd">ImageRequest</span><span class="hk">(</span><span class="hd">$image</span><span class="hk">,&nbsp;</span><span class="hd">$dimensions</span><span class="hk">,&nbsp;</span><span class="hd">$flags</span><span class="hk">,&nbsp;</span><span class="hd">TRUE</span><span class="hk">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$request</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;image&nbsp;request&nbsp;from&nbsp;the&nbsp;image&nbsp;macro&nbsp;arguments.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;&nbsp;$image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array&nbsp;$args<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageRequest<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;static&nbsp;function&nbsp;</span><span class="hd">fromMacro</span><span class="hk">(</span><span class="hd">Meta&nbsp;$image&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">NULL</span><span class="hk">,&nbsp;</span><span class="hd">$args&nbsp;</span><span class="hk">=&nbsp;array())<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span class="hd">$image&nbsp;</span><span class="hk">===&nbsp;</span><span class="hd">NULL</span><span class="hk">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$image&nbsp;</span><span class="hk">=&nbsp;new&nbsp;</span><span class="hd">EmptyImage</span><span class="hk">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span class="hd">ImageRequest</span><span class="hk">(</span><span class="hd">$image</span><span class="hk">,&nbsp;isset(</span><span class="hd">$args</span><span class="hk">[</span><span class="hd">0</span><span class="hk">])&nbsp;?&nbsp;</span><span class="hd">$args</span><span class="hk">[</span><span class="hd">0</span><span class="hk">]&nbsp;:&nbsp;</span><span class="hd">Request</span><span class="hk">::</span><span class="hd">ORIGINAL</span><span class="hk">,&nbsp;isset(</span><span class="hd">$args</span><span class="hk">[</span><span class="hd">1</span><span class="hk">])&nbsp;?&nbsp;</span><span class="hd">$args</span><span class="hk">[</span><span class="hd">1</span><span class="hk">]&nbsp;:&nbsp;</span><span class="hd">Request</span><span class="hk">::</span><span class="hd">ORIGINAL</span><span class="hk">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;boolean<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getCrop</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">crop</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getMeta</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">meta</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;$meta<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Request<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">setMeta</span><span class="hk">(</span><span class="hd">Meta&nbsp;$meta</span><span class="hk">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">meta&nbsp;</span><span class="hk">=&nbsp;</span><span class="hd">$meta</span><span class="hk">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getDimensions</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">dimensions</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getFlags</span><span class="hk">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hd">$this</span><span class="hk">-&gt;</span><span class="hd">flags</span><span class="hk">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#F17" class="toggle">ImageStore/File.php</a></td>
		</tr>
		</table>

		<div class="code" id="F17">
		<div>
			<aside>
			<div><a href='#F17L1' id='F17L1'>  1</a>
<a href='#F17L2' id='F17L2'>  2</a>
<a href='#F17L3' id='F17L3'>  3</a>
<a href='#F17L4' id='F17L4'>  4</a>
<a href='#F17L5' id='F17L5'>  5</a>
<a href='#F17L6' id='F17L6'>  6</a>
<a href='#F17L7' id='F17L7'>  7</a>
<a href='#F17L8' id='F17L8'>  8</a></div><div class='t'><a href='#F17L9' id='F17L9'>  9</a></div><div><a href='#F17L10' id='F17L10'> 10</a>
<a href='#F17L11' id='F17L11'> 11</a>
<a href='#F17L12' id='F17L12'> 12</a>
<a href='#F17L13' id='F17L13'> 13</a>
<a href='#F17L14' id='F17L14'> 14</a>
<a href='#F17L15' id='F17L15'> 15</a>
<a href='#F17L16' id='F17L16'> 16</a>
<a href='#F17L17' id='F17L17'> 17</a>
<a href='#F17L18' id='F17L18'> 18</a>
<a href='#F17L19' id='F17L19'> 19</a>
<a href='#F17L20' id='F17L20'> 20</a>
<a href='#F17L21' id='F17L21'> 21</a>
<a href='#F17L22' id='F17L22'> 22</a>
<a href='#F17L23' id='F17L23'> 23</a>
<a href='#F17L24' id='F17L24'> 24</a>
<a href='#F17L25' id='F17L25'> 25</a>
<a href='#F17L26' id='F17L26'> 26</a>
<a href='#F17L27' id='F17L27'> 27</a>
<a href='#F17L28' id='F17L28'> 28</a>
<a href='#F17L29' id='F17L29'> 29</a>
<a href='#F17L30' id='F17L30'> 30</a>
<a href='#F17L31' id='F17L31'> 31</a>
<a href='#F17L32' id='F17L32'> 32</a>
<a href='#F17L33' id='F17L33'> 33</a>
<a href='#F17L34' id='F17L34'> 34</a>
<a href='#F17L35' id='F17L35'> 35</a>
<a href='#F17L36' id='F17L36'> 36</a>
<a href='#F17L37' id='F17L37'> 37</a>
<a href='#F17L38' id='F17L38'> 38</a>
<a href='#F17L39' id='F17L39'> 39</a>
<a href='#F17L40' id='F17L40'> 40</a>
<a href='#F17L41' id='F17L41'> 41</a>
<a href='#F17L42' id='F17L42'> 42</a>
<a href='#F17L43' id='F17L43'> 43</a>
<a href='#F17L44' id='F17L44'> 44</a>
<a href='#F17L45' id='F17L45'> 45</a>
</div>			</aside>
			<code style='margin-left: 3em'><span class="hh">
<span class="hd">&lt;?php<br /><br /></span><span class="hk">namespace&nbsp;</span><span class="hd">Rostenkowski</span><span class="hk">\</span><span class="hd">ImageStore</span><span class="hk">;<br /><br /><br /></span><span class="hc">/**<br />&nbsp;*&nbsp;Image&nbsp;file&nbsp;interface<br />&nbsp;*/<br /></span><span class="hk">interface&nbsp;</span><span class="hd">File<br /></span><span class="hk">{<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;image&nbsp;filename.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getName</span><span class="hk">();<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;image&nbsp;type.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">getType</span><span class="hk">();<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;image&nbsp;filename.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$name<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">setName</span><span class="hk">(</span><span class="hd">$name</span><span class="hk">);<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hc">/**<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;image&nbsp;type.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$type<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hk">public&nbsp;function&nbsp;</span><span class="hd">setType</span><span class="hk">(</span><span class="hd">$type</span><span class="hk">);<br /><br /><br />}<br /></span>
</span>
</code>		</div>
		</div>
	</div>
	
	<footer>
		<p>Generated by <a href="https://tester.nette.org">Nette Tester</a> at 2016/05/08 15:48:10</p>
	</footer>

	<script>
	document.body.addEventListener('click', function (e) {
		if (e.target.className === 'toggle') {
			var el = document.getElementById(e.target.href.split('#')[1]);
			if (el.style.display === 'block') {
				el.style.display = 'none';
			} else {
				el.style.display = 'block';
			}
			e.preventDefault();
		}
	});

	if (el = document.getElementById(window.location.hash.replace(/^#|L\d+$/g, ''))) {
		el.style.display = 'block';
	}
	</script>
</body>
</html>
